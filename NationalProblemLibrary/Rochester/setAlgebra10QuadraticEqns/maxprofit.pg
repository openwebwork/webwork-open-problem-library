##DESCRIPTION
##  Given price and sales information, find functions for 
##   the demand function, the revenue function, the cost function and 
##   the profit function.
##  Maximize the profit function
##ENDDESCRIPTION
##LEVEL OF DIFFICULTY('hard')
##KEYWORDS('algebra', 'word problem', 'quadratic')

DOCUMENT();        # This should be the first executable line in the problem.

loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl"
);

TEXT(beginproblem());
$showPartialCorrectAnswers = 1;

$price = random(100,400,1);
$quantity = random(1000,50000,1000);
$change = random(10,20,1);
$loss = random(100,1000,100);
$cost = random(.25*$price,.75*$price,.05*$price);
$fixed = random(10000,50000,2000);

$demand = "$quantity - $loss*( (x - $price)/$change)";
$revenue = "x*($quantity - $loss*( (x - $price)/$change))";
$costfunction = "$fixed + $cost*($quantity - $loss*((x - $price)/$change))";
$profit = "$revenue - ($costfunction)";

$bestprice = ($quantity + ($loss*$price/$change) + ($cost*$loss/$change)) / (2*$loss/$change);

BEGIN_TEXT;
The Acme Widget Company has found that if widgets are priced at $DOLLAR $price,
then $quantity will be sold.  They have also found that for every increase of
$DOLLAR $change, there will be $loss fewer widgets sold.
$BR
The marginal cost of
widgets is $DOLLAR $cost.  The fixed costs for the Acme Widget Company are 
$DOLLAR $fixed.
$BR $BR
If \(x\) represents the price of a widget find the following in terms of \(x\):
$BR $BR
The number of widgets that will be sold: \{ans_rule(20)\} $BR $BR
The revenue generated by the sale of widgets: \{ans_rule(20)\} $BR $BR
The cost of producing just enough widgets to meet demand: \{ans_rule(20)\} $BR $BR
The profit from selling widgets:  \{ans_rule(20)\} $BR $BR
Find the price that will maximize profits from the sale of widgets: 
\{ans_rule(10)\}
END_TEXT;

ANS(fun_cmp($demand));
ANS(fun_cmp($revenue));
ANS(fun_cmp($costfunction));
ANS(fun_cmp($profit));
ANS(num_cmp($bestprice));


ENDDOCUMENT();        # This should be the last executable line in the problem.

