# DESCRIPTION
# Problem from Functions Modeling Change, Connally et al., 3rd ed.
# WeBWorK problem written by Adam Spiegler, <aspiegler@luc.edu>
# ENDDESCRIPTION

## DBsubject('Precalculus')
## DBchapter('Logarithmic Functions')
## DBsection('The Logarithmic Functions')
## KEYWORDS('logarithms','log','ln','asymptote','graph of logarithms')
## TitleText1('Functions Modeling Change')
## EditionText1('3')
## AuthorText1('Connally')
## Section1('4.3')
## Problem1('12')
## Author('Adam Spiegler and Paul Pearson')
## Institution('Loyola University Chicago and Fort Lewis College')

######################################
#  Initialization

DOCUMENT();       

loadMacros("PG.pl",
           "PGbasicmacros.pl",
           "PGchoicemacros.pl",
           "PGanswermacros.pl",
           "PGgraphmacros.pl",
           "extraAnswerEvaluators.pl",
           "PGauxiliaryFunctions.pl",
"AnswerFormatHelp.pl",
"unionTables.pl",
"contextInequalities.pl",
"PGcourse.pl",
"parserImplicitPlane.pl",
"parserVectorUtils.pl",
           );
       

TEXT(beginproblem()); # standard preamble to each problem.

$refreshCachedImages = 1;


######################################
#  Setup

Context("Inequalities")->variables->are(x=>"Real",y=>"Real");

$k = random(2,4,1);
$kme = $k - 0.00001;

$f[0] = "1-ln($k-x) for x in <-5,$kme> using color:red and weight:2";
$graph[0] = init_graph(-5,-3,5,5,'axes'=>[0,0],'ticks'=>[10,8]);
$graph[0]->lb(new Label(4.5,0.25,'x','black','center','middle'));
$graph[0]->lb(new Label(0.25,4.5,'y','black','center','middle'));

$f[1] = "1-ln($k+x) for x in <-$kme,5> using color:red and weight:2";
$graph[1] = init_graph(-5,-3,5,5,'axes'=>[0,0],'ticks'=>[10,8]);
$graph[1]->lb(new Label(4.5,0.25,'x','black','center','middle'));
$graph[1]->lb(new Label(0.25,4.5,'y','black','center','middle'));

$f[2] = "1+ln($k-x) for x in <-5,$kme> using color:red and weight:2";
$graph[2] = init_graph(-5,-3,5,5,'axes'=>[0,0],'ticks'=>[10,8]);
$graph[2]->lb(new Label(4.5,0.25,'x','black','center','middle'));
$graph[2]->lb(new Label(0.25,4.5,'y','black','center','middle'));

$f[3] = "1+ln($k+x) for x in <-$kme,5> using color:red and weight:2";
$graph[3] = init_graph(-5,-3,5,5,'axes'=>[0,0],'ticks'=>[10,8]);
$graph[3]->lb(new Label(4.5,0.25,'x','black','center','middle'));
$graph[3]->lb(new Label(0.25,4.5,'y','black','center','middle'));

for ($i = 0; $i <= 3; $i++){
  plot_functions( $graph[$i], $f[$i]); 
  $graph[$i]=image(insertGraph($graph[$i]),width=>200,height=>200,tex_size=>450);
}


@perm = NchooseK(4,4);
@inv = invert(@perm);
@mix_graph = @graph[@perm];

@letter = ("A", "B", "C", "D");
$correct = $letter[$inv[0]];

$vert_asym = "$k";
$hor_asym = "NONE";

$x_int = "$k-e";
$y_int = "1-ln($k)";

#$domain = "(-infinity, $k)";
#$domain = "x<$k";
$DOMAIN = Compute("x<$k");

Context("ImplicitPlane")->variables->are(x=>"Real",y=>"Real");

$VA = ImplicitPlane("x=$k");
$HA = Compute("NONE");

$XINT = Compute("($x_int,0)");
$YINT = Compute("(0,$y_int)");


#################################################
#  Main text

BEGIN_TEXT

Consider the logarithmic equation \( y = 1 - \ln{($k-x)} \).
$BR
$BR
(a) The domain of this function is 
\{ ans_rule(20) \} 
\{ AnswerFormatHelp("inequalities") \} 
$BR
$BR
(b) Determine whether its graph has a horizontal asymptote or a vertical asymptote.  In each answer blank enter an equation \( x = k \) or \( y = k \) for some number ${BITALIC}k,${EITALIC} or, enter ${BITALIC}NONE${EITALIC} if its graph does not have an asymptote.
$BR
The graph has a vertical asymptote with equation 
\{ ans_rule(10) \}
\{ AnswerFormatHelp("equations") \}
$BR
The graph has a horizontal asymptote with equation 
\{ ans_rule(10) \}
\{ AnswerFormatHelp("equations") \}
$BR
$BR
(c)  Determine whether its graph has an x-intercept or a y-intercept.  
In each answer blank enter a point \( (a,b) \) including parentheses, 
or, enter ${BITALIC}NONE${EITALIC} if its graph does not have an intercept.
Enter ${BBOLD}exact${EBOLD} answers, not decimal approximations.
$BR
The graph has an ${BITALIC}x${EITALIC}-intercept at the point 
\{ ans_rule(10) \}
\{ AnswerFormatHelp("points") \}
$BR
The graph has a ${BITALIC}y${EITALIC}-intercept at the point 
\{ ans_rule(10) \}
\{ AnswerFormatHelp("points") \}
$BR
$BR
(d) Without using a calculator, sketch the graph of this equation on paper, labeling the features above.
$BR
$BR
Which graph A-D below most closely matches the graph you drew?
\{ pop_up_list(["?","A","B","C","D"]) \}
$BR
$BR
$BCENTER
\{
BeginTable().
  AlignedRow([$mix_graph[0],$mix_graph[1]]).
  TableSpace(5,0).
  AlignedRow(["A","B"]).
  TableSpace(25,6).
  AlignedRow([$mix_graph[2],$mix_graph[3]]).
  TableSpace(5,0).
  AlignedRow(["C","D"]).
EndTable();
\}
$BR
(Click on a graph to enlarge it.)
$ECENTER

END_TEXT


#########################################
#  Answers

$showPartialCorrectAnswers = 1;

ANS( $DOMAIN->cmp() );
ANS( $VA->cmp() );
ANS( $HA->cmp( typeMatch=>ImplicitPlane("x+y=1") ) );
ANS( $XINT->cmp( tolerance=>0.00000000001,tolType=>"absolute" ) );
ANS( $YINT->cmp( tolerance=>0.00000000001,tolType=>"absolute" ) );
ANS( str_cmp($correct) );

#ANS( Compute("$vert_asym")->cmp(tolerance=>0.0001,tolType=>"absolute") );
#ANS( Compute("$hor_asym") ->cmp(tolerance=>0.0001,tolType=>"absolute") );
#ANS( Compute("$x_int")->cmp(tolerance=>0.0000000001,tolType=>"absolute") );
#ANS( Compute("$y_int")->cmp(tolerance=>0.0000000001,tolType=>"absolute") );
#ANS( str_cmp($correct) );

#ANS( interval_cmp( $domain ) );
#ANS( fun_cmp( $vert_asym,vars=>['N','O','E'] ) );
#ANS( fun_cmp( $hor_asym,vars=>['N','O','E'] ) );
#ANS( fun_cmp( $x_int,vars=>['N','O','E'] ) );
#ANS( fun_cmp( $y_int,vars=>['N','O','E'] ) );
#ANS( std_str_cmp( $correct ) );      


###########################################
#  Solution

SOLUTION(EV3(<<'END_SOLUTION'));
$BR $SPACE $BR 
$BBOLD  SOLUTION $EBOLD
$BR 
$BCENTER
$graph[0]
$ECENTER
$BR
A graph of this function is shown above. We see that the function has a vertical asymptote at $BITALIC x $EITALIC = $k, and the domain is \( (-\infty, $k) \).
$BR
The $BITALIC y${EITALIC}-intercept is when $BITALIC x $EITALIC = 0.  Plugging in  $BITALIC x $EITALIC = 0 we get \( y = 1 - \ln{($k-0)} = 1 - \ln{($k)} \).  Therefore we have a $BITALIC y${EITALIC}-intercept at \( (0, 1- \ln{($k)}) \).
$BR
The $BITALIC x${EITALIC}-intercept is when $BITALIC y $EITALIC =0.  Thus we solve the equation \( 0 = 1- \ln{($k-x)} \).  First we isolate the natural log, \( \ln{($k-x)} = 1 \).  Rewriting this as an exponent, we need to solve \( e^1 =  $k - x \), which gives an $BITALIC x${EITALIC}-intercept at ($k-e, 0).
$BR  
END_SOLUTION
ENDDOCUMENT();   # This should be the last executable line in the problem.