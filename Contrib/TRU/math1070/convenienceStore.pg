## DBsubject(Algebra)
## DBchapter(Linear equations and functions)
## DBsection(Applications and models)
## Level(2)
## KEYWORDS('supply', 'demand', 'price')
## Author(Kyle Schlitt)
## Institution(TRU)
## Language(en)

DOCUMENT();

loadMacros(
  "PGstandard.pl",
  "PGML.pl",
  "contextCurrency.pl",
  "parserImplicitEquation.pl"
);

$slope_num = -(1 + random(5,20,1));
$slope_den = 100;
$m = $slope_num/$slope_den;

$data_q_1 = random(10,20,1);
$data_p_1 = 4 + 0.01*random(0,50,1);

$b = $data_p_1 - $m*$data_q_1;
$q_intercept = $data_q_1 - $data_p_1/$m;

$data_q_2 = $data_q_1 + random(4,10,1);
$data_p_2 = $slope_num/$slope_den*($data_q_2 - $data_q_1) + $data_p_1;

$target_quantity = int($data_q_2 + int(($q_intercept - $data_q_2)/random(2,3,1)));

$target_price = $m*($target_quantity - $data_q_2) + $data_p_2;

$specified_price = -1;

while ($specified_price < 0 || $specified_price == $target_price) {
  $random_multiplier = random(5,15,1);
  $specified_quantity = $data_q_2 + $random_multiplier;
  $specified_price = $data_p_2 + $m * $random_multiplier;
}

Context("Currency");

BEGIN_PGML

A store-owner is marketing a brand new energy drink at a local convenience store.  He observes that [`[$data_q_1]`] cans per day are sold if the price per can is set to [`[@ Currency($data_p_1) @]`], but [`[$data_q_2]`] cans per day are sold if the price is set at [`[@ Currency($data_p_2) @]`] per can.

Assuming there is a linear relationship between

* [`p =`] the price per can, and
* [`q =`] the number of cans sold per day,

find the demand equation, expressed as a relationship between the variables [`p`] and [`q`].

END_PGML

Context("ImplicitEquation");

Context()->variables->add(q => 'Real', p => 'Real');

Context()->variables->set(
  q => { limits => [-10,10]},
  p => { limits => [-10,10]}
);

$demand_equation = ImplicitEquation("p=$m*q + $b");

BEGIN_PGML

**Answer:** [_]{$demand_equation}

----

END_PGML

Context("Currency");

BEGIN_PGML

What should the price be set to in order to sell [`[$target_quantity]`] cans per day -- be sure to include units!

**Answer:** The price should be set to [_]{Currency($target_price)} per can.

----

If the price per can is set to [`[@ Currency($specified_price) @]`], how many cans should the store-owner expect to sell per day?

**Answer:** The store will sell [_]{$specified_quantity} cans per day.

END_PGML

ENDDOCUMENT();