## DBsubject(Algebra)
## DBchapter(Functions)
## DBsection(Interpretation and applications)
## Level(2)
## KEYWORDS('cost', 'revenue', 'profit', 'break-even')
## Author(Kyle Schlitt)
## Institution(TRU)
## Language(en)

DOCUMENT();

loadMacros(
    "PGstandard.pl",
    "PGML.pl",
    "contextCurrency.pl",
);

Context("Currency");
Context()->variables->add(q => "Real");

# parameters for entire question
$variable_cost_per_unit = 30 + random(0,10,1);
$selling_price_per_unit = 120 + random(0,80,10);
$profit_per_unit = $selling_price_per_unit - $variable_cost_per_unit;
$break_even_quantity = 80 + random(0,40,1);
$fixed_cost = $break_even_quantity * ($selling_price_per_unit - $variable_cost_per_unit);
$utils = 800 + random(0,100,10);
$rent = $fixed_cost - $utils;

# parameters for specific parts of question
$target_cost = $fixed_cost + $variable_cost_per_unit * random(600,700,1);

$cost_function = Formula("$fixed_cost + $variable_cost_per_unit q");
$revenue_function = Formula("$selling_price_per_unit q");
$profit_function = Formula("$profit_per_unit q - $fixed_cost");

BEGIN_PGML

Bob runs a shoe-store at a large retail mall.  Each month, he pays [`[@ Currency($rent) @]*`] in rent, with average electric bills in the amount of [`[@ Currency($utils) @]*`].  On average, his suppliers charge [`[@ Currency($variable_cost_per_unit) @]*`] for a pair of shoes, and he sells each pair to customers for [`[@ Currency($selling_price_per_unit) @]*`] dollars.  Assume that Bob has no other costs to worry about.

----

What are the fixed costs?

**Answer:** [_]{Currency($fixed_cost)} per month.

What is the variable cost per unit?

**Answer:** [_]{Currency($variable_cost_per_unit)} per pair of shoes.

END_PGML

BEGIN_PGML_HINT

Remember to include units!  For example, three dollars should be expressed as [`\$3.00`].
END_PGML_HINT

BEGIN_PGML
----

Determine the Cost (C), Revenue (R), and Profit (P) functions, where [`q`] is the number of pairs of shoes that Bob orders and sells -- units are not required here.

**Answers:**

[`C(q)=\ `][_]{$cost_function}

[`R(q)=\ `][_]{$revenue_function}

[`P(q)=\ `][_]{$profit_function}

----

END_PGML

$num_shoes_part_a = 10 + random(0,10,1);
$answer_part_a = $cost_function->substitute(q=>"$num_shoes_part_a")->eval();

$answer_part_b = 400 + random(0,100,10);
$target_cost_part_b = $cost_function->substitute(q=>"$answer_part_b")->eval();

$num_shoes_part_c = 20 + random(0,10,1);
$answer_part_c = $revenue_function->substitute(q=>"$num_shoes_part_c")->eval();

$num_shoes_part_d = random(34,134,5);
$answer_part_d = $profit_function->substitute(q=>"$num_shoes_part_d")->eval();

$answer_part_e = random(147,447,6);
$target_profit_part_e = $profit_function->substitute(q=>"$answer_part_e")->eval();

BEGIN_PGML

Help Bob answer the following questions.  Be sure to include units for any monetary values.  Note that profit will be negative if Bob's company loses money.

What is the total cost for Bob to order [`[$num_shoes_part_a]`] pairs of shoes?

**Answer:** [_]{Currency($answer_part_a)}

Assuming Bob's Total costs are [`[@ Currency($target_cost_part_b) @]*`], how many pairs of shoes did he order?

**Answer:** [_]{$answer_part_b}

How much revenue does Bob generate from selling [`[$num_shoes_part_c]`] pairs of shoes?

**Answer:** [_]{Currency($answer_part_c)}

If Bob orders [`[$num_shoes_part_d]`] pairs of shoes from his supplier, what is his total profit from selling them all?

**Answer:** [_]{Currency($answer_part_d)}

What is Bob's break-even quantity for the month?

**Answer:** [_]{$break_even_quantity}

How many pairs of shoes must Bob sell each month to earn a monthly profit of [`[@ Currency($target_profit_part_e) @]*`]?

**Answer:** [_]{$answer_part_e}

END_PGML

ENDDOCUMENT();
