## DESCRIPTION
## Calculus 1, use the idea of left and right limits to determine if the limit exists
## ENDDESCRIPTION


## DBsubject(Calculus - single variable)
## DBchapter(Limits and continuity)
## DBsection(Estimating limits numerically)
## Date(06/12/2018)
## Institution(Community College of Denver, Colorado Community College System)
## Author(Teresa Adams)
## KEYWORDS('calculus', 'limit')


###########################
#  Initialization

DOCUMENT();

loadMacros(
  "PGstandard.pl",
  "MathObjects.pl",
  "AnswerFormatHelp.pl",
  "PGML.pl",
  "PGcourse.pl",
  "parserAssignment.pl",
  "PGchoicemacros.pl",
  "parserPopUp.pl",
  "PGgraphmacros.pl",
  "scaffold.pl",
  "contextLimitedPoint.pl",
  "weightedGrader.pl",
  "PGessaymacros.pl",
);


TEXT(beginproblem());
$showPartialCorrectAnswers = 1;

install_problem_grader(~~&std_problem_grader);
install_weighted_grader();

###########################
#  Setup

Context("Numeric");

# allowing answers that are within 0.001%
Context()->flags->set(tolerance => 0.00001);

# having answers to 4 decimal places AND reduced
#Context()->{format}{number} = "%.4f#"; 

# the initial x-value in the ordered pairs P(x, y)
$x0 = random ( 1, 5, 1);

# Lseq fills in the first column of table values for x (the left side of x0)
@Lseq = ();
foreach my $i (1..4) {
  $Lseq[$i] = $x0-1/10**$i;
}

# $Rseq fills in the first column of table values for x (the right side of x0)
@Rseq = ();
foreach my $i (1..4) {
  $Rseq[$i] = $x0+1/10**$i;
}


# the formula for the function
$f = Formula("(x^2-$x0^2)/abs(x-$x0)")->reduce(); 


# the answers of the table as an array.  Tables are filled left to right, top to bottom. 
# This is set up for 5x4 answer table (top row is titles, row 1 and two are filled with left or right # of x0) which is why it's mod 2 ($i % 2 == 0 or 1)
@answer = ();
foreach my $i (0..7) {
# the second column where the answer is f(Lseq[k])
  if ($i % 2 == 0) {
     $k = $i/2+1;
     $answer[$i] = $f->eval(x=>$Lseq[$k]);
 } else {
# second column where the answer is f(Rseq[k])     
     $k = ($i+1)/2;
     $answer[$i] = $f->eval(x=>$Rseq[$k]);
 }
}


#this sets up a table that is 5 x 4 where the top row is static and first/third columns are dynamic values of x
$table = $BCENTER.begintable(5) .
row( "`x`", "`f(x)`", "`x`", "`f(x)`" ) .
row( "$Lseq[1]", ans_rule(8), "$Rseq[1]", ans_rule(8)).
row("$Lseq[2]", ans_rule(8), "$Rseq[2]", ans_rule(8)).
row("$Lseq[3]", ans_rule(8), "$Rseq[3]", ans_rule(8)).
row("$Lseq[4]", ans_rule(8), "$Rseq[4]", ans_rule(8)).
endtable().$ECENTER; 


# setting up the limit
$L_lim =  $f->eval(x=>$Lseq[4]); # the limit at x->x0 left
$R_lim = $f->eval(x=>$Rseq[4]); # the limit at x->x0 right

# checking the two sided limit
if ($L_lim == $R_lim ) {
  $answer[8] = $R_lim;
 } else {
  $answer[8]=List("DNE");
}

Context()->strings->add(
  "Does Not Exist"=>{alias=>"DNE"}
);


###########################

#  Main text

Scaffold::Begin();

Section::Begin("Part 1 - 1 point");

BEGIN_PGML

Consider the function [`` f(x) = [$f] ``]. Complete the table with the appropriate values for [`f(x)`]. Round to four decimal places where needed.  [@ AnswerFormatHelp("numbers") @]*

[@ $table @]***

END_PGML

############################
#Hints
#
#
BEGIN_PGML_HINT

Plug each [`x`] value into the function [` f(x) = [$f] `]. Notice that only the denominator of [`f(x)`] has an absolute value, not the numerator.

END_PGML_HINT

############################
#  Part 1 Answer evaluation 

for $i (0..7) {
  WEIGHTED_ANS( ($answer[$i])->cmp(), 34/8 );
}


Section::End();

###########################
# Part 2

Section::Begin("Part 2 - 1 point");

BEGIN_PGML

The results in from the table indicate the two-sided limit of `\lim_{x \to [$x0]} [$f]` is [__________]  (if the two-sided limit does not exist, type in DNE).   [@ AnswerFormatHelp("limits") @]*

END_PGML

############################
#Hints
#
BEGIN_PGML_HINT

Recall, the two sided limit exists if and only if both one sided limits exist and are equal. In other words,

 [``\lim_{x\rightarrow a} f(x)``] exists and is equal to [`L`] if and only if [``\lim_{x\rightarrow a^+} f(x)=\lim_{x\rightarrow a^-} f(x) = L``] 

END_PGML_HINT

############################
#  Part 2 Answer evaluation

WEIGHTED_ANS( ($answer[8])->cmp(), 33);

Section::End();

###########################
# Part 3

#Section::Begin("Part 3 - 1 point");

#BEGIN_PGML

#Please explain your reasoning in the answer box below.  This will be graded by your #instructor manually at a later date.

#[@ essay_box(8,60) @]*


#END_PGML


############################
#  Part 3 Answer evaluation

#WEIGHTED_ANS( essay_cmp(), 33 );

#Section::End();

Scaffold::End();


############################
#  Solution

#BEGIN_PGML_SOLUTION
 
#END_PGML_SOLUTION

COMMENT('MathObject version. Uses PGML.');


ENDDOCUMENT();