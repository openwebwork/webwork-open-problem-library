## BEGIN_DESCRIPTION
##  trig eqn with cos2x
## END_DESCRIPTION
##
##############################################
## DBsubject(Trigonometry)
## DBchapter(Analytic trigonometry)
## DBsection(Solving trigonometric equations exactly)
## Institution(METU-NCC)
## Author(Benjamin Walter)
## Level(2)
## Language(en)
## MO(1)
###############################################


DOCUMENT();        # This should be the first executable line in the problem.

loadMacros(
  "PGstandard.pl",
  "PGcourse.pl",
  "MathObjects.pl",
);


sub pick {
  my ($k, @in) = @_;
  return $in[random(0,$#in)] if ($k==1);
  my @out = ();
  while (@out < $k) { push( @out, splice(@in, random(0,$#in), 1) ); }
  @out;
};


TEXT(beginproblem());

COMMENT("factors: cos x=1 or cos x=1/2 and cos x > 1; or equivalent with sin");

Context("Numeric");
#Context()->constants->remove(pi);
Context()->variables->add(pi=>['Real',TeX=>"\pi"]);
#Context()->flags->set(
#   reduceConstants => 0,
#   reduceConstantFunctions => 0,
#);

my ($a,$b) = PGsort ( sub {$_[0] < $_[1]} , pick(2, (1..6)) );
my ($s,$t) = (random(0,1),random(0,1));      # signs of solutions



if (random(0,1)==0) {  # cos or sin = 1/2
  my ($c,$d) = ($a*(-1)**$s + 2*$b*(-1)**$t, $a + $b*(-1)**($s+$t));

  if (random(0,1)==0) { # cos x = 1/2 
    $f   = Formula("$a cos(2x) + $c cos(x) + $d")->reduce;

    $ans = (List(Formula("2 pi/3"),Formula("4 pi/3")),
            List(Formula("  pi/3"),Formula("5 pi/3")))[$s];

  } else {              # sin x = 1/2
    $f   = Formula("$a cos(2x) - $c sin(x) - $d")->reduce;

    $ans = (List(Formula("7 pi/6"),Formula("11 pi/6")),
            List(Formula("  pi/6"),Formula(" 5 pi/6")))[$s];
  }

} else {               # cos or sin = 1
  ($a,$b)=($a+1,$b+1) if (($a%2)!=0);

  my ($c,$d) = ($a*(-1)**$s + $b*(-1)**$t, $a/2 + $b*(-1)**($s+$t));

  if (random(0,1)==0) { # cos x = 1
    $f   = Formula("$a/2 cos(2x) + $c cos(x) + $d")->reduce;

    $ans = (List(Formula("pi")),
            List(Formula("0")))[$s];

  } else {              # sin x = 1
    $f   = Formula("$a/2 cos(2x) - $c sin(x) - $d")->reduce;

    $ans = (List(Formula("3 pi/2")),
            List(Formula("  pi/2")))[$s];

 }
}

Context()->texStrings;

BEGIN_TEXT

Find all solutions \(x\in [0,2\pi)\).
\[ $f = 0 \]

$PAR

\(\quad x = \) \{ ans_rule(10); \}

$PAR
Note: your answer must be written using "pi" for \(\pi\).
END_TEXT


Context()->normalStrings;

$showPartialCorrectAnswers = 1;

ANS(List($ans)->cmp());


ENDDOCUMENT();        # This should be the last executable line in the problem.

