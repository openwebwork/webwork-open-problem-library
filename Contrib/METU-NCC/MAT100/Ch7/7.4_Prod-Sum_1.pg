## BEGIN_DESCRIPTION
##  Product to Sum Formula
## END_DESCRIPTION
##
##############################################
## DBsubject(Trigonometry)
## DBchapter(Analytic trigonometry)
## DBsection(Product-to-sum & sum-to-product formulas)
## Institution(METU-NCC)
## Author(Benjamin Walter)
## Level(2)
## Language(en)
## MO(1)
###############################################


DOCUMENT();        # This should be the first executable line in the problem.

loadMacros(
  "PGstandard.pl",
  "PGcourse.pl",
  "MathObjects.pl",
);

sub pick {
  my ($k, @in) = @_;
  my @out = ();
  while (@out < $k) { push( @out, splice(@in, random(0,$#in), 1) ); }
  @out; 
};

TEXT(beginproblem());

COMMENT("product to sum formula");


Context("Numeric");
Context()->variables->are(x=>"Real");
Context()->flags->set(
   reduceConstants => 0,
   reduceConstantFunctions => 0,
);
# code below modified from  
# /Library/LoyolaChicago/Precalc/Chap7Sec3/Connally3-7-3-01-Angle-sum-formulas.pg
Context()->functions->remove("sin","cos");
package NewFunc;
# this next line makes the function a
# function from reals to reals
our @ISA = qw(Parser::Function::numeric);
sub sin {
  shift; my $x = shift;
  return $x - $x**3 / 6;
}
sub cos {
  shift; my $x = shift;
  return 1 - $x**2 / 2;
}
package main;
# Make it work on formulas as well as numbers
#sub sin {Parser::Function->call('sin',@_)} # if uncommented, this line will generate error messages
#  Add the new functions to the Context
Context()->functions->add( 
  sin => {class => 'NewFunc', TeX => '\sin'}, 
  cos => {class => 'NewFunc', TeX => '\cos'}
);

($a,$b) = pick(2,(1..9));

my @sum = (
  Formula("1/2(sin(($a+$b) x) + sin(($a-$b) x))"), 
  Formula("1/2(sin(($a+$b) x) + sin(($b-$a) x))"), 
  Formula("1/2(cos(($a+$b) x) + cos(abs($a-$b) x))"), 
  Formula("1/2(cos(abs($a-$b) x) - cos(($a+$b) x))")
); 
$a = "" if ($a==1);
$b = "" if ($b==1);
my @prod =(
  Formula("sin($a x) cos($b x)"),
  Formula("cos($a x) sin($b x)"),
  Formula("cos($a x) cos($b x)"),
  Formula("sin($a x) sin($b x)")
);

my @p = pick(4,(0..3));

@q   = @prod[@p];
@ans = @sum[@p];

@index = ("a","b","c","d","e","f","g");

Context()->texStrings;

BEGIN_TEXT

Convert products to sums.

END_TEXT
for($i=0;$i<=$#ans;$i++) {
BEGIN_TEXT

$PAR
($index[$i]) \(\quad $q[$i] = \) \{ans_rule(10);\}

END_TEXT
}

Context()->normalStrings;

$showPartialCorrectAnswers = 1;

foreach (0..$#ans) { ANS($ans[$_]->cmp()); }


ENDDOCUMENT();        # This should be the last executable line in the problem.

