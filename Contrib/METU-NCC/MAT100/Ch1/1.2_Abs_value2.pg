## BEGIN_DESCRIPTION
##  Solve equality with sum of absolute values
## END_DESCRIPTION
##
##############################################
## DBsubject(Algebra)
## DBchapter(Absolute value expressions and functions)
## DBsection(Solving equations with absolute values)
## Institution(METU-NCC)
## Author(Benjamin Walter)
## Date(October 2022)
## MO(1)
## Static(0)
## Level(2)
## Language(en)
###############################################



DOCUMENT();

loadMacros(
"PGstandard.pl",
"PGcourse.pl",
"MathObjects.pl",
"contextFraction.pl"
);

TEXT(beginproblem());

COMMENT('random slopes could make answers ugly...');

sub pick {
  my ($k, @in) = @_;
  my @out = ();
  while (@out < $k) { push( @out, splice(@in, random(0,$#in), 1) ); }
  @out;
}

Context("Fraction");


do {
  @a = map { non_zero_random(-4,4); } (0,1); 
  @m = map { random(1,3) } @a; 
} until ($a[0]*$m[1] != $a[1]*$m[0]);

if ($a[0]*$m[1] > $a[1]*$m[0]) { @a = @a[1,0]; @m = @m[1,0]}

@crit  = (abs($m[1]*$a[0]/$m[0] - $a[1]), abs($m[0]*$a[1]/$m[1] - $a[0]));
@crits = PGsort(sub {$_[0] < $_[1]}, @crit);

do { $b = random(ceil($crits[0])+1,ceil($crits[1])+4); } 
until ($b != $crits[1]);

@x = ();

if ($b > $crit[0]) {
  push(@x, (
   Fraction($a[0]+$a[1]-$b,
            $m[0]+$m[1])->reduce
  ));
}
if ($b == (PGsort(sub {$_[0] < $_[1]}, ($b,$crit[0],$crit[1])))[1]) {
  push(@x, (
   Fraction(-$a[0]+$a[1]-$b,
            -$m[0]+$m[1])->reduce
  ));
}
if ($b > $crit[1]) { 
  push(@x, (
   Fraction($a[0]+$a[1]+$b,
            $m[0]+$m[1])->reduce
  ));
}

$ans = List(@x);

# if (random(0,1)==1) {@a=@a[1,0]; @m=@m[1,0];}

$f = Formula("abs($m[0] x - $a[0]) + abs($m[1] x - $a[1])")->reduce;

Context()->texStrings;
BEGIN_TEXT

Solve the following equation. 
\[ \displaystyle $f = $b\]
$PAR
\(x= \) \{ $ans->ans_rule(10) \}


END_TEXT
Context()->normalStrings;

ANS( $ans->cmp() );


ENDDOCUMENT();        # This should be the last executable line in the problem.
       
