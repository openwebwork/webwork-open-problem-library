## DESCRIPTION
## Generates bool, string, and int expressions in ML 
## using if-then-else and asks for their values and types.
## ENDDESCRIPTION

## DBsubject(Programming Languages)
## DBchapter(ML)
## DBsection(BasicTypesOperators)
## Date(12/04/2025)
## Institution(Louisiana Tech)
## Author(Jason Terry)
## Level(2)
## KEYWORDS('programming languages','ml','sml','expressions','type','operators','string','ifthenelse','bool')


DOCUMENT();

## Load libraries
loadMacros(
"PGstandard.pl",
"PGcourse.pl",
"contextArbitraryString.pl",
"parserPopUp.pl",
"PGML.pl"
);

## Change context to strings answers
Context("ArbitraryString");

## Create answer to static problem
$ans1 = String("~~"arcsine~~"");

## Create parameters for boolean statements
$a = random(1,20,1);
$b = random(1,20,1);
$c = random(1,3,1);
$d = random(21,30,1);
$e = random(31,40,1);

## Create answers to boolean statements
if ($a < $b) { $ans2 = String("~~"yes~~""); } else { $ans2 = String("~~"no~~""); }
if ($c == 2) {$ans3 = $d;} else {$ans3 = $e;}
if ($c == 3) {$ans4 = String("false");} else {$ans4 = String("true");}
if ($a < $b || $c == 2) {$ans5 = String("true");} else {$ans5 = String("false");}

## Create the popup menus with the correct ML type answers
$popInt = PopUp(["Choose...","int","bool","real","char","string"], 1);
$popBool = PopUp(["Choose...","int","bool","real","char","string"], 2);
$popReal = PopUp(["Choose...","int","bool","real","char","string"], 3);
$popChar = PopUp(["Choose...","int","bool","real","char","string"], 4);
$popString = PopUp(["Choose...","int","bool","real","char","string"], 5);

## Display question
TEXT(beginproblem());

BEGIN_PGML
Determine the value and type returned when the following ML expressions are evaluated.

    *\"arc\" ^ \"sine\" ^ \"\";*

    *val it = [__________]{$ans1} : [_____]{$popString}*
===
    *if ([$a] < [$b]) then \"yes\" else \"no\";*

    *val it = [__________]{$ans2} : [_____]{$popString}*
===
    *if ([$c] = 2) then [$d] else [$e];*

    *val it = [__________]{$ans3} : [_____]{$popInt}*
===
    *if ([$c] = 3) then false else true;*

    *val it = [__________]{$ans4} : [_____]{$popBool}*
===
    *[$a] < [$b] orelse [$c] = 2;*

    *val it = [__________]{$ans5} : [_____]{$popBool}*


END_PGML

BEGIN_PGML_SOLUTION
Solution:

    *\"arc\" ^ \"sine\" ^ \"\";*

    *val it = [$ans1] : [$popString] *
===
    *if ([$a] < [$b]) then \"yes\" else \"no\";*

    *val it = [$ans2] : [$popString] *
===
    *if ([$c] = 2) then [$d] else [$e];*

    *val it = [$ans3] : [$popInt] *
===
    *if ([$c] = 3) then false else true;*

    *val it = [$ans4] : [$popBool] *
===
    *[$a] < [$b] orelse [$c] = 2;*

    *val it = [$ans5] : [$popBool] *

END_PGML_SOLUTION

ENDDOCUMENT();
