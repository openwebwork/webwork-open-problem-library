## DESCRIPTION
## Generates arithmetic expressions in ML and asks for value and type.
## ENDDESCRIPTION

## DBsubject(Programming Languages)
## DBchapter(ML)
## DBsection(BasicTypesOperators)
## Date(12/04/2025)
## Institution(Louisiana Tech)
## Author(Jason Terry)
## Level(2)
## KEYWORDS('programming languages','ml','sml','expressions','type','operators')


DOCUMENT();

## Load libraries
loadMacros(
"PGstandard.pl",
"PGcourse.pl",
"parserPopUp.pl",
"PGML.pl"
);

## Change context to numeric answers
Context("Numeric");

## Generate random numbers for problems.
$a = random(1,3,1);
$b = random(4,6,1);
$c = random(7,9,1);
$d = random(1,7,2);

## Generate solutions to problems
$ans1 = $a + $b * $c;
$ans2 = ($a + $b) * $c;
$ans3 = $c - $d/2.0;
$ans4 = int(($b*$c)/3);
$ans5 = ($b*$c) % 3;

## Create the popup menus with the correct ML type answers
$popInt = PopUp(["Choose...","int","bool","real","char","string"], 1);
$popBool = PopUp(["Choose...","int","bool","real","char","string"], 2);
$popReal = PopUp(["Choose...","int","bool","real","char","string"], 3);
$popChar = PopUp(["Choose...","int","bool","real","char","string"], 4);
$popString = PopUp(["Choose...","int","bool","real","char","string"], 5);

## Display question
TEXT(beginproblem());

BEGIN_PGML
Determine the value and type returned when the following ML expressions are evaluated.

    *[$a] + [$b] * [$c];*

    *val it = [__________]{$ans1} : [_____]{$popInt}*
===
    *([$a] + [$b]) * [$c];*

    *val it = [__________]{$ans2} : [_____]{$popInt}*
===
    *[$c].0 - [$d].0 / 2.0;*

    *val it = [__________]{$ans3} : [_____]{$popReal}*
===
    *([$b]\*[$c]) div 3;*

    *val it = [__________]{$ans4} : [_____]{$popInt}*
===
    *([$b]\*[$c]) mod 3;*

    *val it = [__________]{$ans5} : [_____]{$popInt}*


END_PGML

BEGIN_PGML_SOLUTION
Solution:

    *[$a] + [$b] * [$c];*

    *val it = [$ans1] : [$popInt] *
===
    *([$a] + [$b]) * [$c];*

    *val it = [$ans2] : [$popInt] *
===
    *[$c].0 - [$d].0 / 2.0;*

    *val it = [$ans3] : [$popReal] *
===
    *([$b]\*[$c]) div 3;*

    *val it = [$ans4] : [$popInt] *
===
    *([$b]\*[$c]) mod 3;*

    *val it = [$ans5] : [$popInt] *

END_PGML_SOLUTION

ENDDOCUMENT();
