## DESCRIPTION
## Generates expressions in ML and asks if they are valid.
## Tests common misconceptions when learning ML
## ENDDESCRIPTION

## DBsubject(Programming Languages)
## DBchapter(ML)
## DBsection(BasicTypesOperators)
## Date(12/04/2025)
## Institution(Louisiana Tech)
## Author(Jason Terry)
## Level(2)
## KEYWORDS('programming languages','ml','sml','expressions','type','operators','valid','invalid')


DOCUMENT();

## Load libraries
loadMacros(
"PGstandard.pl",
"PGcourse.pl",
##"niceTables.pl",
##"contextArbitraryString.pl",
"parserPopUp.pl",
"PGML.pl"
);

## Do not reveal partial solutions for popup questions.
$showPartialCorrectAnswers = 0;

## Generate random numbers for problems.
$a = random(1,3,1);
$b = random(4,6,1);
$c = random(7,9,1);
$d = random(1,7,2);

## Create the popup menus with the correct ML type answers
$popValid = PopUp(["Choose...","Valid","Invalid"], 1);
$popInvalid = PopUp(["Choose...","Valid","Invalid"], 2);

## Display question
TEXT(beginproblem());

BEGIN_PGML
Determine whether the following ML expressions are valid or invalid

    [_]{$popInvalid} : *[$b] / [$a];*

    [_]{$popInvalid} : *if [$b]<[$c] then [$d];*

    [_]{$popValid} : *[$d] div [$b] mod [$c];*

    [_]{$popValid} : *if [$a] < [$b] then [$c].0 else [$d].0;*

    [_]{$popInvalid} : *[$b]<[$c] or [$d]<[$a];*

END_PGML

BEGIN_PGML_SOLUTION
Solution:

    [$popInvalid] : *[$b] / [$a];*

    [$popInvalid] : *if [$b]<[$c] then [$d];*

    [$popValid] : *[$d] div [$b] mod [$c];*

    [$popValid] : *if [$a] < [$b] then [$c].0 else [$d].0;*

    [$popInvalid] : *[$b]<[$c] or [$d]<[$a];*

END_PGML_SOLUTION

ENDDOCUMENT();
