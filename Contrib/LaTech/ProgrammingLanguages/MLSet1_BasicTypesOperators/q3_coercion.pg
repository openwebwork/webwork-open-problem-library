## DESCRIPTION
## Generates expressions using coercion in ML and asks for value and type.
## ENDDESCRIPTION

## DBsubject(Programming Languages)
## DBchapter(ML)
## DBsection(BasicTypesOperators)
## Date(12/04/2025)
## Institution(Louisiana Tech)
## Author(Jason Terry)
## Level(2)
## KEYWORDS('programming languages','ml','sml','expressions','type','operators','ceil','floor','chr','str','ord','coercion')


DOCUMENT();

## Load libraries
loadMacros(
"PGstandard.pl",
"PGcourse.pl",
##"niceTables.pl",
##"contextArbitraryString.pl",
"parserPopUp.pl",
"PGML.pl"
);

## Change context to numeric answers
Context("Numeric");

## Create string for output
Context()->strings->add("~~"Q~~"" => {caseSensitive => 1});
Context()->strings->add("#~~"a~~"" => {caseSensitive => 1});

## Generate random numbers for problems.
$a = random(-30.1,-10.1,0.2);
$b = random(100,115,1);
$c = random(7,9,1);
$d = random(1,7,2);

## Generate solutions to problems
$ce = ceil($a);
$fl = floor($a);
$abs_a = abs($a);
$p = abs($ce);
$q = abs($fl);
Context()->strings->add("~~~$p" => {caseSensitive => 1});
Context()->strings->add("~~~$q" => {caseSensitive => 1});
$ans1 = String("~~~$p");
$ans2 = String("~~~$q");
$ans3 = $b;
$ans4 = String("~~"Q~~"");
$ans5 = String("#~~"a~~"");

## Create the popup menus with the correct ML type answers
$popInt = PopUp(["Choose...","int","bool","real","char","string"], 1);
$popBool = PopUp(["Choose...","int","bool","real","char","string"], 2);
$popReal = PopUp(["Choose...","int","bool","real","char","string"], 3);
$popChar = PopUp(["Choose...","int","bool","real","char","string"], 4);
$popString = PopUp(["Choose...","int","bool","real","char","string"], 5);

## Display question
TEXT(beginproblem());

BEGIN_PGML
Determine the value and type returned when the following ML expressions are evaluated.

    *ceil(~[$abs_a]);*

    *val it = [__________]{$ans1} : [_____]{$popInt}*
===
    *floor(~[$abs_a]);*

    *val it = [__________]{$ans2} : [_____]{$popInt}*
===
    *ord(chr([$b]));*

    *val it = [__________]{$ans3} : [_____]{$popInt}*
===
    *str(#\"Q\");*

    *val it = [__________]{$ans4} : [_____]{$popString}*
===
    *chr(97);*

    *val it = [__________]{$ans5} : [_____]{$popChar}*


END_PGML

BEGIN_PGML_SOLUTION
Solution:

No solution available yet.


END_PGML_SOLUTION

## There is some mistake in the PGML CODE Solution below
##    *ceil(~[$abs_a]);*
##
##    *val it = [$ans1] : [$popInt]*
##===
##    *floor(~[$abs_a]);*
##
##    *val it = [$ans2] : [$popInt]*
##===
##    *ord(chr([$b]));*
##
##    *val it = [$ans3] : [$popInt]*
##===
##    *str(#\"Q\");*
##
##    *val it = [$ans4] : [$popString]*
##===
##    *chr(97);*
##
##    *val it = [$ans5] : [$popChar]*

ENDDOCUMENT();
