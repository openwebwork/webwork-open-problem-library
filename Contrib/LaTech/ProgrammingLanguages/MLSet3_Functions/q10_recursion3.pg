## DESCRIPTION
## Generates mutually recursive ML functions and ask for values returned.
## ENDDESCRIPTION

## DBsubject(Programming Languages)
## DBchapter(ML)
## DBsection(Functions)
## Date(12/05/2025)
## Institution(Louisiana Tech)
## Author(Jason Terry)
## Level(2)
## KEYWORDS('programming languages','ml','sml','mutual','recursion','function')


DOCUMENT();

## Load libraries
loadMacros(
"PGstandard.pl",
"PGcourse.pl",
"PGML.pl"
);

## Set context to numeric answers
Context("Numeric");

## Create first ML function
sub f {
    my $n = $_[0];
    if ($n == 0) {
        return($r1);
    } else {
        return( $n + g($n-1) );
    }
}

## Create second ML function
sub g {
    my $n = $_[0];
    if ($n == 0) {
        return($r2);
    } else {
        return( $n + f($n-1) );
    }
}

## Create random parameters
$r1 = random(1,3,1);
$r2 = random(4,6,1);

## Create random inputs
$n1 = random(5,7,1);

## Create answers to problems
$ans1 = f(1);
$ans2 = g(1);
$ans3 = f(3);
$ans4 = f($n1);
$ans5 = g($n1);

## Display question
TEXT(beginproblem());

BEGIN_PGML
Consider the following mutually recursive ML functions:

    *fun f 0 = [$r1] *

    *| f n = n + g(n-1)*

    *and*

    *g 0 = [$r2] *

    *| g n = n + f(n-1);*

Determine the value returned by the following expressions:

    f(1) = [__________]{$ans1}

    g(1) = [__________]{$ans2}

    f(3) = [__________]{$ans3}

    f([$n1]) = [__________]{$ans4}

    g([$n1]) = [__________]{$ans5}

END_PGML

BEGIN_PGML_SOLUTION
Solution:

    f(1) = [$ans1]

    g(1) = [$ans2]

    f(3) = [$ans3]

    f([$n1]) = [$ans4]

    g([$n1]) = [$ans5]

END_PGML_SOLUTION

ENDDOCUMENT();
