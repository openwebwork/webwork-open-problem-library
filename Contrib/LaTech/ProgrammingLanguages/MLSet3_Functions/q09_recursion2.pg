## DESCRIPTION
## Gives a recursive ML function with some random
## inputs and ask for values returned.
## ENDDESCRIPTION

## DBsubject(Programming Languages)
## DBchapter(ML)
## DBsection(Functions)
## Date(12/05/2025)
## Institution(Louisiana Tech)
## Author(Jason Terry)
## Level(2)
## KEYWORDS('programming languages','ml','sml','recursion','function')


DOCUMENT();

## Load libraries
loadMacros(
"PGstandard.pl",
"PGcourse.pl",
"PGML.pl"
);

## Set context to numeric answers
Context("Numeric");

## Create ML function
sub myfun {
    my $n = $_[0];
    if ($n == 1) {
        return(1);
    } elsif ($n == 2) {
        return(1);
    } else {
        return( myfun(myfun($n-1)) + myfun($n-myfun($n-1)) );
    }
}

## Create random parameters
$n1 = random(5,7,1);
$n2 = random(8,10,1);

## Create answers to problems
$ans1 = myfun(1);
$ans2 = myfun(2);
$ans3 = myfun(3);
$ans4 = myfun($n1);
$ans5 = myfun($n2);

## Display question
TEXT(beginproblem());

BEGIN_PGML
Consider the following recursive ML function:

    *fun myfun 1 = 1 *

    *| myfun 2 = 1 *

    *| myfun n = myfun(myfun(n-1)) + myfun(n-myfun(n-1));*

Determine the value returned by the following expressions:

    myfun(1) = [__________]{$ans1}

    myfun(2) = [__________]{$ans2}

    myfun(3) = [__________]{$ans3}

    myfun([$n1]) = [__________]{$ans4}

    myfun([$n2]) = [__________]{$ans5}

END_PGML

BEGIN_PGML_SOLUTION
Solution:

    myfun(1) = [$ans1]

    myfun(2) = [$ans2]

    myfun(3) = [$ans3]

    myfun([$n1]) = [$ans4]

    myfun([$n2]) = [$ans5]

END_PGML_SOLUTION

ENDDOCUMENT();
