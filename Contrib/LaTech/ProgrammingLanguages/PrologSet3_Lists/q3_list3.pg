## DESCRIPTION
## Generates Prolog goals using lists and built-in predicates and asks for result from unification.
## ENDDESCRIPTION

## DBsubject(Programming Languages)
## DBchapter(Prolog)
## DBsection(Lists)
## Date(01/01/2026)
## Institution(Louisiana Tech)
## Author(Jason Terry)
## Level(2)
## KEYWORDS('programming languages','prolog','unification','lists','member','last','select')


DOCUMENT();

## Load libraries
loadMacros(
"PGstandard.pl",
"PGcourse.pl",
"contextArbitraryString.pl",
"PGML.pl"
);

## Change context to strings answers
Context("ArbitraryString");

## Create function to normalize strings into specific format
sub normalize {
    my ($s) = @_;               # get input string
    $s =~ tr/ //ds;             # strip all whitespace
    $s =~ tr/.//ds;             # strip all periods
    @arr = split(/,/,$s);       # split string on commas
    @sorted = lex_sort(@arr);   # sort strings
    $new = join(',',@sorted);   # recombine into one string
    return($new);               # return recombined string
}

## Create custom answer checker for prolog input
$prologChecker = sub {
        my ($correct,$student,$ansHash) = @_;  # get correct and student MathObjects
        $correct = $correct->string;
        $student = $student->string;
        return (normalize($correct) eq normalize($student));  # return 1 if correct, 0 otherwise
};

## Create random parameters for questions
$a = random(1,5,1);
$b = random(6,9,1);
$c = random(10,15,1);

## Create answers to questions
$ans1 = String("true")->cmp(
    checker => $prologChecker
);

$ans2 = String("R=c$c")->cmp(
    checker => $prologChecker
);

$ans3 = String("false")->cmp(
    checker => $prologChecker
);
    
$ans4 = String("R=[a$a,b$b]")->cmp(
    checker => $prologChecker
);

$ans5 = String("false")->cmp(
    checker => $prologChecker
);

## Display question
TEXT(beginproblem());

BEGIN_PGML
Determine whether the following Prolog statements would succeed or fail, and then which variables, if any, would be instantiated to which values. Write your answer on the blank line provided *IN THE CORRECT FORMAT AS FOLLOWS*.

If the statement fails, your response should be:

    *false*

If the statement succeeds and there are no variable instantiations, your response should be:

    *true*

If the statement succeeds and there are variable instantiations, your response should be:

    *<Variable1> = <value1>, <Variable2> = <value2>, <etc.>*

===

    *member(b[$b],\[a[$a],b[$b],c[$c]\]).*

    [________________________________________]{$ans1}

===

    *last(\[a[$a],b[$b],c[$c]\],R).*

    [________________________________________]{$ans2}

===

    *last(\[\],R).*

    [________________________________________]{$ans3}

===

    *select(c[$c],\[a[$a],b[$b],c[$c]\],R).*

    [________________________________________]{$ans4}

===

    *select(a,\[a[$a],b[$b],c[$c]\],R).*

    [________________________________________]{$ans5}

===

END_PGML

BEGIN_PGML_SOLUTION
Solution:

===

    *member(b[$b],\[a[$a],b[$b],c[$c]\]).*

    true

===

    *last(\[a[$a],b[$b],c[$c]\],R).*

    R=c[$c]

===

    *last(\[\],R).*

    false

===

    *select(c[$c],\[a[$a],b[$b],c[$c]\],R).*

    R=\[a[$a],b[$b]\]

===

    *select(a,\[a[$a],b[$b],c[$c]\],R).*

    false

===

END_PGML_SOLUTION

ENDDOCUMENT();
