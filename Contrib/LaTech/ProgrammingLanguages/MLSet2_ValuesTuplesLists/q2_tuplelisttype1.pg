## DESCRIPTION
## Generates ML expressions using tuples and lists and asks for their types.
## ENDDESCRIPTION

## DBsubject(Programming Languages)
## DBchapter(ML)
## DBsection(Data Structures)
## Date(12/04/2025)
## Institution(Louisiana Tech)
## Author(Jason Terry)
## Level(2)
## KEYWORDS('programming languages','ml','sml','expressions','type','tuple','list')


DOCUMENT();

## Load libraries
loadMacros(
"PGstandard.pl",
"PGcourse.pl",
"contextArbitraryString.pl",
"PGML.pl"
);

## Change context to strings answers
Context("ArbitraryString");

## Create custom answer checker for ML types
$typeChecker = sub {
        my ($correct,$student,$ansHash) = @_;  # get correct and student MathObjects
        $correct = $correct->string;
        $student = $student->string;
        $student =~ s/^ *(.*?) *$/$1/;     # remove front/end whitespace
        $student =~ s/ *~~* */~~*/g;       # * shall have no space on each side
        $student =~ s/~~( */~~(/g;         # ( shall have no space after
        $student =~ s/ *~~)/~~)/g;         # ) shall have no space before
        $student =~ s/ *list/ list/g;      # list shall have 1 space before
        return ($correct eq $student);     # return 1 if correct, 0 otherwise
    };

$a = random(1,20,1);
$b = random(1,20,1);
$c = random(1,20,1);

## Create answers to problems and install custom type checker
$ans1 = String("int*string")->cmp(
        checker => $typeChecker
    );

$ans2 = String("real*bool*char")->cmp(
        checker => $typeChecker
    );

$ans3 = String("(real*bool)*char")->cmp(
        checker => $typeChecker
    );

$ans4 = String("bool list")->cmp(
        checker => $typeChecker
    );

$ans5 = String("int list list")->cmp(
        checker => $typeChecker
    );


## Display question
TEXT(beginproblem());

BEGIN_PGML
Write the type of the following ML expressions. *WARNING: Only use required parentheses for types to match the ML compiler's response.*

    *([$a], \"hello\") : [_________________________]{$ans1}*
===
    *([$b].4, true, #\"q\") : [_________________________]{$ans2}*
===
    *(([$b].4, true), #\"q\") : [_________________________]{$ans3}*
===
    *\[false\] : [_________________________]{$ans4}*
===
    *\[\[[$c]\]\] : [_________________________]{$ans5}*


END_PGML

BEGIN_PGML_SOLUTION
Solution:

    *([$a],\"hello\") : int\*string*
===
    *([$b].4,true,#\"q\") : real\*bool\*char*
===
    *(([$b].4,true),#\"q\") : (real\*bool)\*char*
===
    *\[false\] : bool list*
===
    *\[\[[$c]\]\] : int list list*


END_PGML_SOLUTION

ENDDOCUMENT();
