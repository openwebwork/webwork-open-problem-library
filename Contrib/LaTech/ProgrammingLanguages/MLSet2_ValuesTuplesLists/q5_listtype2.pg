## DESCRIPTION
## Generates list expressions in ML and asks for their value and type.
## ENDDESCRIPTION

## DBsubject(Programming Languages)
## DBchapter(ML)
## DBsection(Data Structures)
## Date(12/04/2025)
## Institution(Louisiana Tech)
## Author(Jason Terry)
## Level(2)
## KEYWORDS('programming languages','ml','sml','expressions','type','list')


DOCUMENT();

## Load libraries
loadMacros(
"PGstandard.pl",
"PGcourse.pl",
"contextArbitraryString.pl",
"PGML.pl"
);

## Change context to strings answers
Context("ArbitraryString");

## Create custom answer checker for ML types
$typeChecker = sub {
        my ($correct,$student,$ansHash) = @_;  # get correct and student MathObjects
        $correct = $correct->string;
        $student = $student->string;
        $student =~ s/^ *(.*?) *$/$1/;     # remove front/end whitespace
        $student =~ s/ *~~* */~~*/g;       # * shall have no space on each side
        $student =~ s/~~( */~~(/g;         # ( shall have no space after
        $student =~ s/ *~~)/~~)/g;         # ) shall have no space before
        $student =~ s/ *list/ list/g;      # list shall have 1 space before
        return ($correct eq $student);     # return 1 if correct, 0 otherwise
    };

## Create custom answer checker for ML values
$valChecker = sub {
        my ($correct,$student,$ansHash) = @_;  # get correct and student MathObjects
        $correct = $correct->string;
        $student = $student->string;
        $student =~ tr/ //ds;               # strip all whitespace
        return ($correct eq $student);      # return 1 if correct, 0 otherwise
    };

$a = random(0,9,1);
$b = random(0,9,1);
$c = random(0,9,1);
$d = random(0,9,1);
$e = random(0,9,1);
$f = random(97,106,1);
$g = random(97,106,1);
$s = chr($f) . chr($g);

## Create value answers to problems and install custom value checker
$ans1 = String("[$a,$b,$c]")->cmp(
        checker => $valChecker
    );

$ans2 = String("$c")->cmp(
        checker => $valChecker
    );

$s1 = String("#~~"$c~~"");
$s2 = String("#~~"$d~~"");
$s3 = String("#~~"$e~~"");
$ans3 = String("[$s1,$s2,$s3]")->cmp(
        checker => $valChecker
    );

$ans4 = String("~~"$a$b$c~~"")->cmp(
        checker => $valChecker
    );

$ans5 = String("~~"$s~~"")->cmp(
        checker => $valChecker
    );

## Create type answers to problems and install custom type checker
$type1 = String("int list")->cmp(
        checker => $typeChecker
    );

$type2 = String("int")->cmp(
        checker => $typeChecker
    );

$type3 = String("char list")->cmp(
        checker => $typeChecker
    );

$type4 = String("string")->cmp(
        checker => $typeChecker
    );

$type5 = String("string")->cmp(
        checker => $typeChecker
    );


## Display question
TEXT(beginproblem());

BEGIN_PGML
Write the value and type of the following ML expressions. *WARNING: Only use required parentheses for tuples and types to match the ML compiler's response.*

    *[$a]::[$b]::\[[$c]\];*

    *val it = [_________________________]{$ans1} : [_________________________]{$type1}*
===
    *hd(tl(tl(\[[$a],[$b],[$c],[$d],[$e]\])));*

    *val it = [_________________________]{$ans2} : [_________________________]{$type2}*
===
    *tl(tl(\[#\"[$a]\",#\"[$b]\",#\"[$c]\"\]@explode(\"[$d][$e]\")));*

    *val it = [_________________________]{$ans3} : [_________________________]{$type3}*
===
    *implode(\[#\"[$a]\",#\"[$b]\",#\"[$c]\"\]);*

    *val it = [_________________________]{$ans4} : [_________________________]{$type4}*
===
    *str(chr([$f]))^str(chr([$g]));*

    *val it = [_________________________]{$ans5} : [_________________________]{$type5}*

    Hint: The integer value of #\"a\" is 97.
END_PGML

BEGIN_PGML_SOLUTION
Solution:

No solution available yet.

END_PGML_SOLUTION

ENDDOCUMENT();
