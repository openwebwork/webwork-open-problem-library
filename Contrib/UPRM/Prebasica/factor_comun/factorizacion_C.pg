#  DESCRIPTION
#
#  Tipo: Selección múltiple, única respuesta
#  Factorizacion: factor común tipo: 
#   ax^n1y^m1 + bx^n2y^m2 + cx^n3y^m3 = mcd(a,b,c)x^min(n1,n2,n3)y^min(m1,m2,m3)*(   lo que queda  )

#  Problema WeBWork escrito por Edwin Florez, 
#  <edwin.florez (at) upr (dot) edu>
#
#  Adaptado desde el sistema quiz.uprm.edu del archivo
#  pedro_prebasica/factor_comun/factorizacion.db
#
#  ENDDESCRIPTION

## DBsubject(Prebasica)
## DBchapter(Factorizacion)
## DBsection(Factor común)
## Level(1)
## KEYWORDS('factorizacion','factor comun')
## Author(Edwin Florez)
## Institution(UPRM)
## Language(es)

DOCUMENT();

loadMacros(
"PGstandard.pl",
"MathObjects.pl",
"PGgraphmacros.pl",
"contextInequalities.pl",
"AnswerFormatHelp.pl",
"PGchoicemacros.pl",
"contextFraction.pl",
"problemRandomize.pl",
"parserRadioButtons.pl"
);

TEXT(beginproblem());
#$refreshCachedImages = 1;

#  Allow for the user to try another version of the problem once they get it correct.
ProblemRandomize(when=>"Correct",onlyAfterDue=>0);

# Show which answers are correct and which ones are incorrect
#$showPartialCorrectAnswers = 0;

##############################################################
#  Setup

Context("Numeric");

#las constantes de la expresión a factorizar: a x^n1 y^m1 + b x^n2 y^m2 + c x^n3 y^m3
$k = list_random(1,2,3,5,7);
$a = $k*non_zero_random(-20,20);
$b = $k*non_zero_random(-20,20);
$c = $k*non_zero_random(-20,20);

$n1 = random(2,20);
$m1 = random(2,20);
$n2 = random(2,20);
$m2 = random(2,20);
$n3 = random(2,20);
$m3 = random(2,20);
 
#eligiendo las variables
$var1 = list_random('a','b','m','n','x','y','z','w','p','q','r','s','t','u','v');
do {
 $var2 = list_random('a','b','m','n','x','y','z','w','p','q','r','s','t','u','v');
} until ($var2 ne $var1);

#adicionando las variables al contexto
Context()->variables->are($var1=>"Real", uc($var1)=>"Real", $var2=>"Real", uc($var2)=>"Real");
Context()->noreduce('y-x');

$exp = Compute("$a$var1**($n1)$var2**($m1)+$b$var1**($n2)$var2**($m2)+$c$var1**($n3)$var2**($m3)")->reduce;

$fcc = gcd(gcd($a,$b),$c);
$mns = min($n1,$n2,$n3);
$mms = min($m1,$m2,$m3);

$mcd_term =  Formula("$fcc$var1**($mns)$var2**($mms)")->reduce;

$t1 = Compute("$a/$fcc$var1**($n1-$mns) $var2**($m1-$mms)")->reduce;
$t2 = Compute("$b/$fcc$var1**($n2-$mns) $var2**($m2-$mms)")->reduce; 
$t3 = Compute("$c/$fcc$var1**($n3-$mns) $var2**($m3-$mms)")->reduce; 

$temp_exp = Compute("$mcd_term*$t1+$mcd_term*$t2+$mcd_term*$t3")->reduce;

#Opciones a mostrar junto con la respuesta
$r = Compute("$mcd_term($t1+$t2+$t3)")->reduce->TeX;
$r1 = Compute("$fcc($a/$fcc$var1**($n1)$var2**($m1)+$b/$fcc$var1**($n2)$var2**($m2)+$c/$fcc$var1**($n3)$var2**($m3))")->reduce->TeX;
$r2 = Compute("$var1$var2($a$var1**($n1-1)$var2**($m1-1)+$b$var1**($n2-1)$var2**($m2-1)+$c$var1**($n3-1)$var2**($m3-1))")->reduce->TeX;
$r3 = Compute("$fcc$var1$var2( $a/$fcc$var1**($n1-1)$var2**($m1-1)+$b/$fcc$var1**($n2-1)$var2**($m2-1)+$c/$fcc$var1**($n3-1)$var2**($m3-1))")->reduce->TeX;

$radio = RadioButtons( [
  "\($r\)",
  "\($r1\)",
  "\($r2\)",
  "\($r3\)",
  "Ninguna de las otras"] ,
     "\($r\)", 
     last =>["Ninguna de las otras"],
     labels => "ABC",
     separator => "$BR$BR"
);

##############################################################
#
#  Text
#

Context()->texStrings;
BEGIN_TEXT
Factorice la siguiente expresión
\[
$exp
\]
$PAR
\{ $radio->buttons() \}
END_TEXT
Context()->normalStrings;

#Context("Numeric");
##############################################################
#  Answers
#

install_problem_grader(~~&std_problem_grader);

$showPartialCorrectAnswers = 0;

ANS( $radio->cmp() );

Context()->texStrings;
SOLUTION(EV3(<<'END_SOLUTION'));
$BBOLD Paso 1:$EBOLD Calcular el máximo común divisor (MCD) de los términos, en este caso es:
\[
  $mcd_term
\]
$PAR
$BBOLD Paso 2:$EBOLD Aislar el MCD en cada expresión
\[
$exp = $temp_exp
\]
$PAR
$BBOLD Paso 2:$EBOLD Usar la ley distributiva para factorizar el MCD asegurándose poner entre paréntesis la expresión restante
\[
$temp_exp =  $r
\]
$PAR
Por lo tanto la respuesta es: \($r\)
END_SOLUTION
Context()->normalStrings;

ENDDOCUMENT();