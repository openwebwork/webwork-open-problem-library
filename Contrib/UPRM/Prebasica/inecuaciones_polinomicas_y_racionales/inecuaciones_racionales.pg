#  DESCRIPTION
#
#  Tipo: respuesta corta
#  Inecuaciones racionales: tipo (x+a)/(x+b) [>,<,>=,<=] 0 
#  encontrar solución en forma de intervalo.
#  a y b enteros no cero

#  Problema WeBWork escrito por Edwin Florez, 
#  <edwin.florez (at) upr (dot) edu>
#
#  Adaptado desde el sistema quiz.uprm.edu del archivo
#  pedro_prebasica/inecuaciones_polinomicas_y_racionales/inecuaciones_racionales.db
#
#  Última actualización: Edwin F. 07/30/2014
#  ENDDESCRIPTION

## DBsubject(Prebasica)
## DBchapter(Inecuaciones)
## DBsection(Racionales)
## Level(1)
## KEYWORDS('factorizacion','inecuaciones','racional')
##
## DBCCSS('')
## TitleText1('')
## EditionText1('')
## AuthorText1('')
## Section1('')
## Problem1('')
##
## Author(Edwin Florez)
## Institution(UPRM)
## Language(es)

##############################################

DOCUMENT();

loadMacros(
"PGstandard.pl",
"MathObjects.pl",
"PGgraphmacros.pl",
"contextInequalities.pl",
"AnswerFormatHelp.pl",
"PGchoicemacros.pl",
"contextFraction.pl",
"problemRandomize.pl",
"parserRadioButtons.pl",
"UPRMgraphMacros.pl",
"contextInequalities.pl",
"unionTables.pl"
);

TEXT(beginproblem());
$refreshCachedImages = 1;

#  Allow for the user to try another version of the problem once they get it correct.
ProblemRandomize(when=>"Correct",onlyAfterDue=>0);

# Show which answers are correct and which ones are incorrect
#$showPartialCorrectAnswers = 0;

##############################################################
#  Setup

Context("Numeric");

#creando aleatoriamente la inecuacion (x+a)/(x+b)  [>,<,>=,<=]  0
$a = non_zero_random(-9,9);
do{
 $b = non_zero_random(-9,9);
}until( $b != $a );

#usado para simplificar en caso que a y b sean negativos. 
$ma = -$a;
$mb = -$b;

@list_desig_tex = (">","<","\geq","\leq");
@list_desig = (">","<",">=","<=");
$index = random(0,3);

$min_mamb = min(-$a,-$b);
$max_mamb = max(-$a,-$b);

$punto_prueba1 = $min_mamb - 1;
$punto_prueba3 = $max_mamb + 1;
$punto_prueba2 = ($max_mamb + $min_mamb)/2;

Context()->noreduce('(-x)+y', '(-x)-y');
$f = Formula("(x+$a)/(x+$b)")->reduce;

Context("Fraction");

$fpp1 = Fraction( $f->eval(x=>$punto_prueba1) )->reduce;
$fpp2 = Fraction( $f->eval(x=>$punto_prueba2) )->reduce;
$fpp3 = Fraction( $f->eval(x=>$punto_prueba3) )->reduce;

Context("Inequalities");

#Subrutina que retorna un "+" o "-" si el número ingresado 
#es positivo o negativo
sub signo {
   local $a =  $_[0];
   if ( $a > 0 ) { return "\(+\)";}
   if ( $a < 0 ) { return "\(-\)";}
   if ( $a == 0 ) { return "\(0\)";}
}

#creando el intervalo solución
if ( $index == 0 ){
  $answer = Union( Compute( "(-Inf,$min_mamb)" ) ,  Compute( "($max_mamb,Inf)" ) );
  $paso_extra = "";
}elsif ($index == 1){
  $answer = Compute( "($min_mamb,$max_mamb)" );
  $paso_extra = "";
}elsif ($index == 2){
  if ( $mb == $min_mamb ){
      $answer = Union( Compute( "(-Inf,$min_mamb)" ) ,  Compute( "[$max_mamb,Inf)" ) );
      $extremo = $max_mamb;
  }else{
      $answer = Union( Compute( "(-Inf,$min_mamb]" ) ,  Compute( "[$max_mamb,Inf)" ) );
      $extremo = $min_mamb;
  }
$paso_extra = "$PAR Note que hemos añadido el extremo \( $extremo \), pues al sustituirlo en la fracción obtenemos cero.";
}else{
  if ( $mb == $min_mamb ){
      $answer = Compute( "($min_mamb,$max_mamb]" );
      $extremo = $max_mamb;
  }else{
      $answer = Compute( "[$min_mamb,$max_mamb)" );
      $extremo = $min_mamb;
  }
$paso_extra = "$PAR Note que hemos añadido el extremo \( $extremo \), pues al sustituirlo en la fracción obtenemos cero.";
}

##############################################################
#
#  Text
#

Context()->texStrings;
BEGIN_TEXT
Hallar el conjunto solución de la siguiente inecuación
\[
 $f $list_desig_tex[$index] 0
\]
$PAR
Contestación: \{ans_rule(20)\} \{ AnswerFormatHelp("intervals") \}
END_TEXT
Context()->normalStrings;

#Context("Numeric");
##############################################################
#  Answers
#

ANS( $answer->cmp() );

Context()->texStrings;
SOLUTION(EV3(<<'END_SOLUTION'));
$BBOLD Paso 1:$EBOLD Hallar los valores que hacen cero a cada factor de la fracción:
\[
 \begin{align*}
  x + $a &= 0 \quad \Rightarrow \quad x = $ma \\
  x + $b &= 0 \quad \Rightarrow \quad x = $mb,
 \end{align*}
\]
entonces los intervalos de prueba serán \( (-\infty,$min_mamb), ($min_mamb,$max_mamb) \) y \( ($max_mamb,\infty) \).
$PAR
$BBOLD Paso 2:$EBOLD Seleccionar un punto de prueba dentro de cada intervalo anterior para determinar el signo que tiene la expresión \( \displaystyle $f. \) 
$PAR
\{
 BeginTable(border=>1, tex_border=>"1pt", spacing=>0, padding=>4).
 AlignedRow( [ "$BBOLD Intervalo$EBOLD", "$BBOLD Punto de Prueba$EBOLD", "$BBOLD Evaluar$EBOLD", "$BBOLD Signo$EBOLD"], align=>CENTER, separation=>0). 
 AlignedRow( [ "\( (-\infty,$min_mamb) \)", "\( $punto_prueba1 \)", "\( \displaystyle\frac{($punto_prueba1)+$a}{($punto_prueba1)+$b} = $fpp1 \)", signo($fpp1) ], align=>CENTER, separation=>0).
 AlignedRow( [ "\( ($min_mamb,$max_mamb) \)", "\( $punto_prueba2 \)", "\( \displaystyle\frac{($punto_prueba2)+$a}{($punto_prueba2)+$b} = $fpp2 \)", signo($fpp2) ], align=>CENTER, separation=>0).
 AlignedRow( [ "\( ($max_mamb,\infty) \)", "\( $punto_prueba3 \)", "\( \displaystyle\frac{($punto_prueba3)+$a}{($punto_prueba3)+$b}  = $fpp3 \)", signo($fpp3) ], align=>CENTER, separation=>0).
EndTable()
\}
$PAR
Buscamos los valores de \(x\) que hagan la fracción \($list_desig_tex[$index] 0\). Basándonos en la tabla anterior, el conjunto solución es: \($answer\).
$paso_extra
END_SOLUTION
Context()->normalStrings;

ENDDOCUMENT();