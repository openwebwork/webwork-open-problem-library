#  DESCRIPTION
#
#  Tipo: seleccionar varias respuestas correctas
#  Identificar números en un intervalo dado

#  Problema WeBWork escrito por Edwin Florez, 
#  <edwin.florez (at) upr (dot) edu>
#
#  Adaptado desde el sistema quiz.uprm.edu del archivo
#  pedro_prebasica/intervalos/numeros_en_intervalo.db
#
#  ENDDESCRIPTION

## DBsubject(Prebasica)
## DBchapter(Intervalos)
## DBsection(Identificar valores)
## Level(1)
## KEYWORDS('intervalos','identificar')
## Author(Edwin Florez)
## Institution(UPRM)
## Language(es)

DOCUMENT();

loadMacros(
"PGstandard.pl",
"MathObjects.pl",
"PGgraphmacros.pl",
"contextInequalities.pl",
"AnswerFormatHelp.pl",
"PGchoicemacros.pl",
"contextFraction.pl",
"problemRandomize.pl",
"PGpolynomialmacros.pl",
"parserRadioButtons.pl"
);

TEXT(beginproblem());
$refreshCachedImages = 1;

#  Allow for the user to try another version of the problem once they get it correct.
ProblemRandomize(when=>"Correct",onlyAfterDue=>0);

# Show which answers are correct and which ones are incorrect
$showPartialCorrectAnswers = 0;

##############################################################
#  Setup

#Extremos del intervalo
$a = random(-25,0,0.01);
$b = random(0.01,25,0.01);

#####################################################
#Esta parte es para mejorar a futuro
#####################################################

#tipo de intervalo aleatoriamente (a,b), (a,b], [a,b), [a,b]
#$tipo = random(0,3);
#
#eligiendo aleatoriamente cantidad de números dentro del intervalo 
#$num_dentro = random(0,5);

######################################################
## hasta aqui
######################################################

#Puntos dentro del intervalo
$r1 = random($a, $b, 0.01);
$r2 = random($a, $b, 0.01);
$r3 = random($a, $b, 0.01);

#Puntos fuera del intervalo
$prob = random(0,2);
if ($prob == 0){
  $r4 = random(-50, $a+0.01, 0.01);
  $r5 = random($b+0.01, 50, 0.01);
}elsif($prob == 1){
  $izq_o_der = random(0,1);
  if ($izq_o_der == 0){
    $r4 = $a;
    $r5 = random($b+0.01, 50, 0.01);
  }else{
    $r4 = random($b+0.01, 50, 0.01); 
    $r5 = $b;
  }
}else{
 $r4 = $a;
 $r5 = $b;
}

$mc = new_checkbox_multiple_choice();
$mc -> qa (
"¿Cuál de los siguientes números se encuentran en el intervalo \( ($a,$b) \)?.  Podrían ser mas de uno.", 
"\( $r1 \)$BR",
"\( $r2 \)$BR",                
"\( $r3 \)$BR"
);
$mc -> extra(
"\( $r4 \)$BR",
"\( $r5 \)$BR",
);
$mc -> makeLast("Ninguna de las anteriores");

#haciendo la representación para la solución
$gr = init_graph($a-5,-1,$b+5,1, size=>[800,100]);

$gr -> moveTo($a-5,0);
$gr -> lineTo($b+5,0,'black','1');

#Esto no funciona por ahora
#my @arr_ticks;
#$index = 0;
#foreach my $i (ceil($a)..floor($b)){
#  $arr_ticks[$index] = $i;
#  $index = $index + 1;
#}
# las marcas del eje x, entrada como: valor en y, color y lista de valores
#$gr -> h_ticks(0,"black",$arr_ticks);
# creando las etiquetas de las marcas en la forma: x,y,label,color, posición horiz y posición vert 
#foreach my $j (ceil($a)..floor($b)) {
#  $gr->lb( new Label($j,-0.5,$j, 'black','center','middle'));
#}

$gr -> moveTo($a,0.0);
$gr -> lineTo($b,0.0,'blue',3);
$gr -> stamps( open_circle($a,0.0,'blue') );
$gr->lb(new Label($a,0.5,$a,'blue','center','middle'));
$gr -> stamps( open_circle($b,0.0,'blue') );
$gr->lb(new Label($b,0.5,$b,'blue','center','middle'));

#dibujando los puntos dentros del intervalo
$gr -> stamps( closed_circle($r1,0.0,'red') );
$gr->lb(new Label($r1,-0.5,$r1,'red','center','middle'));
$gr -> stamps( closed_circle($r2,0.0,'red') );
$gr->lb(new Label($r2,-0.5,$r2,'red','center','middle'));
$gr -> stamps( closed_circle($r3,0.0,'red') );
$gr->lb(new Label($r3,-0.5,$r3,'red','center','middle'));

##############################################################
#
#  Text
#

Context()->texStrings;
BEGIN_TEXT
\{ $mc -> print_q() \}
$BR
\{ $mc -> print_a() \}
END_TEXT
Context()->normalStrings;

#Context("Numeric");
##############################################################
#  Answers
#

install_problem_grader(~~&std_problem_grader);

$showPartialCorrectAnswers = 0;

ANS( checkbox_cmp( $mc->correct_ans() ) );

Context()->texStrings;
SOLUTION(EV3(<<'END_SOLUTION'));
La representación gráfica 
$PAR
$BCENTER
\{ image(insertGraph($gr), width=>640, height=>100, tex_size=>320); \}
$ECENTER
$PAR
muestra que los valores \($r1, $r2\) y \($r3\) están dentro del intervalo \( ($a,$b) \), por lo tanto las soluciones son: \{ $mc->correct_ans() \}
END_SOLUTION
Context()->normalStrings;

ENDDOCUMENT();