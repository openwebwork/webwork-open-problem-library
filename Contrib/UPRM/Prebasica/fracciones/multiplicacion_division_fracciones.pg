#  DESCRIPTION
#
#  Tipo: respuesta corta
#  Multiplicar o dividir dos fracciones

#  Problema WeBWork escrito por Edwin Florez, 
#  <edwin.florez (at) upr (dot) edu>
#
#  Adaptado desde el sistema quiz.uprm.edu del archivo
#  pedro_prebasica/fracciones/multiplicacion_division_fracciones.db
#
#  ENDDESCRIPTION

## DBsubject(Prebasica)
## DBchapter(Fracciones)
## DBsection(Multiplicacion y division)
## Level(1)
## KEYWORDS('fracciones','mixtas','multiplicacion','division')
## Author(Edwin Florez)
## Institution(UPRM)
## Language(es)

DOCUMENT();

loadMacros(
"PGstandard.pl",
"MathObjects.pl",
"PGgraphmacros.pl",
"contextInequalities.pl",
"AnswerFormatHelp.pl",
"PGchoicemacros.pl",
"contextFraction.pl",
"problemRandomize.pl",
"PGpolynomialmacros.pl"
);

TEXT(beginproblem());
#$refreshCachedImages = 1;

#  Allow for the user to try another version of the problem once they get it correct.
ProblemRandomize(when=>"Correct",onlyAfterDue=>0);

# Show which answers are correct and which ones are incorrect
#$showPartialCorrectAnswers = 0;

##############################################################
#  Setup

#eligiendo los numeradores y denominadores
$a = random(2,20);
do {
 $b = random(2,20);
}until ($b != $a);

$c = random(2,20);
do {
 $d = random(2,20);
}until ($d != $c);


Context("Fraction");
$f1 = Fraction($a,$b);
$f2 = Fraction($c,$d);

@primes = (2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199);
 
#Usado para retornar la factorización prima de un número 
sub factor {
     my $n = shift;
     my $i = 0;
     my $pfactors = "";
 
     while ($n > 1){
 	while ( ($n % $primes[$i] ) == 0 ){
 	    $pfactors = $pfactors."$primes[$i]\cdot";
            $n = $n/$primes[$i];
 	}
 	$i++;
     }
    $pfactors = substr $pfactors, 0, -5;
    return $pfactors;
}

$fa = factor($a);
$fb = factor($b);
$fc = factor($c);
$fd = factor($d);

$prob = random(0,1);
if ($prob == 0){

 $opera = "*";
 $exp_text1 ="La multiplicación de fracciones es directa, numerador con numerador y denominador con denominador,
 \[
  \frac{$a}{$b} \cdot \frac{$c}{$d} = \frac{$a\cdot $c}{$b\cdot $d}
 \]
 pero antes si se puede hacemos,";
 
 $exp_text2 ="\frac{$fa}{$fb} \cdot \frac{$fc}{$fd}";
 $simbolo = "\cdot";
 
}else{

 $opera = "/";
 $exp_text1 ="Convertir en multiplicación pues esta se realiza, numerador con numerador y denominador con denominador,
 \[
   \frac{$a}{$b} \div \frac{$c}{$d} = \frac{$a}{$b}\cdot \frac{$d}{$c} = \frac{$a\cdot $d}{$b \cdot $c}
  \]
 pero antes si se puede hacemos,";
 
 $exp_text2 ="\frac{$fa}{$fb} \cdot \frac{$fd}{$fc}";

 $simbolo = "\div";

}


$answer = Compute("$f1 $opera $f2")->reduce;

##############################################################
#
#  Text
#

Context()->texStrings;
BEGIN_TEXT
Realice la siguiente operación
\[
\frac{$a}{$b} $simbolo \frac{$c}{$d}
\]
y simplifique su resultado completamente.
$PAR
Contestación: \{ans_rule(20)\} \{ AnswerFormatHelp("number") \}
END_TEXT
Context()->normalStrings;

#Context("Numeric");
##############################################################
#  Answers
#

ANS( $answer->cmp(studentsMustReduceFractions=>1, requirePureFractions=>1) );

Context()->texStrings;
SOLUTION(EV3(<<'END_SOLUTION'));
$BBOLD Paso 1:$EBOLD $exp_text1
$PAR
$BBOLD Paso 2:$EBOLD escribir numeradores y denominadores como producto de primos y simplificar antes de multiplicar.
$BR
Luego
\[
\frac{$a}{$b} $simbolo \frac{$c}{$d} = $exp_text2  = $answer.
\]
Por lo tanto la solución es: \($answer\)
END_SOLUTION
Context()->normalStrings;

ENDDOCUMENT();