#  DESCRIPTION
#
#  Tipo: respuesta corta
#  Inecuaciones polinomicas: tipo ax^2 + bx + c  [>,<,>=,<=] 0 
#  encontrar solución en forma de intervalo.
#  Respuestas enteras, usando C(x-A)(x-B)
#  para formar ax^2 + bx + c = 0, donde a=C, b=-C(A+B) y c = ABC

#  Problema WeBWork escrito por Edwin Florez, 
#  <edwin.florez (at) upr (dot) edu>
#
#  Adaptado desde el sistema quiz.uprm.edu del archivo
#  pedro_prebasica/inec_cuad-sol/inec_cuad_tut1_sp.db
#
#  Última actualización: Edwin F. 07/31/2014
#
#  ENDDESCRIPTION

## DBsubject(Prebasica)
## DBchapter(Inecuaciones)
## DBsection(Polinomicas)
## Level(1)
## KEYWORDS('factorizacion','inecuaciones', 'polinomios')
##
## DBCCSS('')
## TitleText1('')
## EditionText1('')
## AuthorText1('')
## Section1('')
## Problem1('')
##
## Author(Edwin Florez)
## Institution(UPRM)
## Language(es)

##############################################

DOCUMENT();

loadMacros(
"PGstandard.pl",
"MathObjects.pl",
"PGgraphmacros.pl",
"contextInequalities.pl",
"AnswerFormatHelp.pl",
"PGchoicemacros.pl",
"contextFraction.pl",
"problemRandomize.pl",
"parserRadioButtons.pl",
"UPRMgraphMacros.pl",
"contextInequalities.pl",
"unionTables.pl"
);

TEXT(beginproblem());
$refreshCachedImages = 1;

#  Allow for the user to try another version of the problem once they get it correct.
ProblemRandomize(when=>"Correct",onlyAfterDue=>0);

# Show which answers are correct and which ones are incorrect
#$showPartialCorrectAnswers = 0;

##############################################################
#  Setup

Context("Numeric");

#Creando las constantes para ax^2+bx+c

#Partiendo de C(x-A)(x-B)
$A = non_zero_random(-9,9);
$B = non_zero_random(-9,9);
$C = non_zero_random(-1,1);

#Construimos ax^2+bx+c
$a = $C;
$b = -$C*($A+$B);
$c = $A*$B*$C;

@list_desig_tex = (">","<","\geq","\leq");
@list_desig = (">","<",">=","<=");
$index = random(0,3);

@val_cero = PGsort( sub {$_[0] < $_[1]} , ($A,$B) );

$punto_prueba1 = $val_cero[0] - 1;
$punto_prueba2 = ($val_cero[0] + $val_cero[1])/2;
$punto_prueba3 = $val_cero[1] + 1;

Context()->noreduce('(-x)+y', '(-x)-y');
$f = Formula("$a x^2 + $b x + $c")->reduce;
$fa = Formula("$C(x-$A)(x-$B)")->reduce;

$fpp1 = $f->eval(x=>$punto_prueba1);
$fpp2 = $f->eval(x=>$punto_prueba2);
$fpp3 = $f->eval(x=>$punto_prueba3);

#Subrutina que retorna un "+" o "-" si el número ingresado 
#es positivo o negativo
sub signo {
   local $a =  $_[0];
   if ( $a > 0 ) { return "\(+\)";}
   if ( $a < 0 ) { return "\(-\)";}
   if ( $a == 0 ) { return "\(0\)";}
}

Context("Inequalities");

#creando el intervalo solución
if ( $index == 0 ){
  $answer = Union( Compute( "(-Inf,$val_cero[0])" ) ,  Compute( "($val_cero[1],Inf)" ) );
  $paso_extra = "";
}elsif ($index == 1){
  $answer = Compute( "($val_cero[0],$val_cero[1])" );
  $paso_extra = "";
}elsif ($index == 2){
  $answer = Union( Compute( "(-Inf,$val_cero[0]]" ) ,  Compute( "[$val_cero[1],Inf)" ) );
  $paso_extra = "$PAR Note que hemos añadido todos los extremos que son números, pues al sustituirlos en el polinomio obtenemos cero.";
}else{
  $answer = Compute( "[$val_cero[0],$val_cero[1]]" );
  $paso_extra = "$PAR Note que hemos añadido todos los extremos que son números, pues al sustituirlos en el polinomio obtenemos cero.";
}

##############################################################
#
#  Text
#

Context()->texStrings;
BEGIN_TEXT
Resolver la siguiente inecuación
\[
 $f $list_desig_tex[$index] 0
\]
$PAR
Contestación: \{ans_rule(20)\} \{ AnswerFormatHelp("intervals") \}
END_TEXT
Context()->normalStrings;

#Context("Numeric");
##############################################################
#  Answers
#

ANS( $answer->cmp() );

Context()->texStrings;
SOLUTION(EV3(<<'END_SOLUTION'));
$BBOLD Paso 1:$EBOLD Factorizar el polinomio:
\[
$f  = $fa
\]
$PAR
$BBOLD Paso 2:$EBOLD Hallar los intervalos de prueba, igualando cada factor a cero:
\[
 \begin{align*}
  x - $A &= 0 \quad \Rightarrow \quad x = $A \\
  x - $B &= 0 \quad \Rightarrow \quad x = $B,
 \end{align*}
\]
entonces los intervalos de prueba serán \( (-\infty,$val_cero[0]), ($val_cero[0],$val_cero[1]) \) y \( ($val_cero[1],\infty) \).
$PAR
$BBOLD Paso 3:$EBOLD Seleccionar un punto de prueba dentro de cada intervalo anterior para determinar el signo que tiene la expresión \( $f \). 
$PAR
\{
 BeginTable(border=>1, tex_border=>"1pt", spacing=>0, padding=>4).
 AlignedRow( [ "$BBOLD Intervalo$EBOLD", "$BBOLD Punto de Prueba$EBOLD", "$BBOLD Evaluar$EBOLD", "$BBOLD Signo$EBOLD"], align=>CENTER, separation=>0). 
 AlignedRow( [ "\( (-\infty,$val_cero[0]) \)", "\( $punto_prueba1 \)", "\( $a ($punto_prueba1)^2 + $b ($punto_prueba1) + $c  = $fpp1 \)", signo($fpp1) ], align=>CENTER, separation=>0).
 AlignedRow( [ "\( ($val_cero[0],$val_cero[1]) \)", "\( $punto_prueba2 \)", "\( $a ($punto_prueba2)^2 + $b ($punto_prueba2) + $c  = $fpp2 \)", signo($fpp2) ], align=>CENTER, separation=>0).
 AlignedRow( [ "\( ($val_cero[1],\infty) \)", "\( $punto_prueba3 \)", "\( $a ($punto_prueba3)^2 + $b ($punto_prueba3) + $c  = $fpp3 \)", signo($fpp3) ], align=>CENTER, separation=>0).
EndTable()
\}
$PAR
Buscamos los valores de \(x\) que hagan el polinomio \($list_desig_tex[$index] 0\). Basándonos en la tabla anterior, el conjunto solución es: \($answer\).
$paso_extra
END_SOLUTION
Context()->normalStrings;

ENDDOCUMENT();