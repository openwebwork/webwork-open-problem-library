#  DESCRIPTION
#
#  Tipo: respuesta corta
#  Inecuaciones lineales con valor absoluto: tipo |ax+b|  [>,<,>=,<=] c 
#  encontrar solución en forma de intervalo.
#  a = 1, -1 y b y c son enteros no cero

#  Problema WeBWork escrito por Edwin Florez, 
#  <edwin.florez (at) upr (dot) edu>
#
#  Adaptado desde el sistema quiz.uprm.edu del archivo
#  pedro_prebasica/inec_cuad-sol/inec_cuad_tut2_sp.db
#
#  Última actualización: Edwin F. 07/31/2014
#
#  ENDDESCRIPTION

## DBsubject(Prebasica)
## DBchapter(Inecuaciones)
## DBsection(Valor absoluto)
## Level(1)
## KEYWORDS('valor absoluto','inecuaciones')
##
## DBCCSS('')
## TitleText1('')
## EditionText1('')
## AuthorText1('')
## Section1('')
## Problem1('')
##
## Author(Edwin Florez)
## Institution(UPRM)
## Language(es)

##############################################

DOCUMENT();

loadMacros(
"PGstandard.pl",
"MathObjects.pl",
"PGgraphmacros.pl",
"contextInequalities.pl",
"AnswerFormatHelp.pl",
"PGchoicemacros.pl",
"contextFraction.pl",
"problemRandomize.pl",
"parserRadioButtons.pl",
"UPRMgraphMacros.pl",
"contextInequalities.pl",
"unionTables.pl"
);

TEXT(beginproblem());
$refreshCachedImages = 1;

#  Allow for the user to try another version of the problem once they get it correct.
ProblemRandomize(when=>"Correct",onlyAfterDue=>0);

# Show which answers are correct and which ones are incorrect
#$showPartialCorrectAnswers = 0;

##############################################################
#  Setup

Context("Numeric");

#Creando las constantes para |ax+b|  [>,<,>=,<=] c 

$a = non_zero_random(-1,1);
$b = non_zero_random(-20,20);
do{
 $c = non_zero_random(-20,20);
}until ($c != $b);

@list_desig_tex = (">","<","\geq","\leq");
@list_desig = (">","<",">=","<=");
$index = random(0,3);

$pt1 = ($c - $b)/$a;
$pt2 = (-$c - $b)/$a;

@val_cero = PGsort( sub {$_[0] < $_[1]} , ($pt1,$pt2) );

$punto_prueba1 = $val_cero[0] - 1;
$punto_prueba2 = ($val_cero[0] + $val_cero[1])/2;
$punto_prueba3 = $val_cero[1] + 1;

Context()->noreduce('(-x)+y', '(-x)-y');
$f = Formula("|$a x + $b|")->reduce;
$fa = Formula("$a x + $b")->reduce;
$fa2 = Formula("$a x")->reduce;

$fpp1 = $f->eval(x=>$punto_prueba1);
$fpp2 = $f->eval(x=>$punto_prueba2);
$fpp3 = $f->eval(x=>$punto_prueba3);

$fa2pp1 = $fa2->eval(x=>$punto_prueba1);
$fa2pp2 = $fa2->eval(x=>$punto_prueba2);
$fa2pp3 = $fa2->eval(x=>$punto_prueba3);

#Subrutina que retorna un "+" o "-" si el número ingresado 
#es positivo o negativo
sub vverdad {
   local ($x, $y, $idx) = ($_[0], $_[1],$_[2]);
   if ( $idx == 0 ) { return $x > $y ? "Cierto" : "Falso";}
   if ( $idx == 1 ) { return $x < $y ? "Cierto" : "Falso";}
   if ( $idx == 2 ) { return $x >= $y ? "Cierto" : "Falso";}
   if ( $idx == 3 ) { return $x <= $y ? "Cierto" : "Falso";}
}

Context("Inequalities");

#creando el intervalo solución
if ( $index == 0 ){   # Aqui se usa para >
  if ( $c > 0){
      $answer = Union( Compute( "(-Inf,$val_cero[0])" ) ,  Compute( "($val_cero[1],Inf)" ) );
      $paso_extra = "";
  }else{
      $answer = Compute( "(-Inf,Inf)" );
      $paso_extra = "$PAR Note que se satisfacen todos los intervalos de prueba, por lo tanto la solución son todos los reales. 

$PAR En este tipo de ejercicio se puede llegar a la solución rápidamente si nos damos cuenta que el valor absoluto siempre da como resultado un número no negativo.";
  }
}elsif ($index == 1){ # Aqui se usa para <
   if ( $c > 0){
      $answer = Compute( "($val_cero[0],$val_cero[1])" );
      $paso_extra = "";
  }else{
      $answer = Compute( "{ }" );
      $paso_extra = "$PAR Como ninguno de los intervalos de prueba se satisface, no hay solución real. 

$PAR En este tipo de ejercicio se puede llegar a la solución rápidamente si nos damos cuenta que el valor absoluto siempre da como resultado un número no negativo.";
 }
}elsif ($index == 2){ # Aqui se usa para >=
   if ( $c > 0){
      $answer = Union( Compute( "(-Inf,$val_cero[0]]" ) ,  Compute( "[$val_cero[1],Inf)" ) );
      $paso_extra = "";
  }else{
      $answer = Compute( "(-Inf,Inf)" );
      $paso_extra = "$PAR Note que se satisfacen todos los intervalos de prueba, por lo tanto la solución son todos los reales. 

$PAR En este tipo de ejercicio se puede llegar a la solución rápidamente si nos damos cuenta que el valor absoluto siempre da como resultado un número no negativo.";
  }
}else{    # Aqui se usa para <=
 if ( $c > 0){
      $answer = Compute( "[$val_cero[0],$val_cero[1]]" );
      $paso_extra = "";
  }else{
      $answer = Compute( "{ }" );
      $paso_extra = "$PAR Como ninguno de los intervalos de prueba se satisface, no hay solución real. 

$PAR En este tipo de ejercicio se puede llegar a la solución rápidamente si nos damos cuenta que el valor absoluto siempre da como resultado un número no negativo.";
 }
}

##############################################################
#
#  Text
#

Context()->texStrings;
BEGIN_TEXT
Resolver la siguiente inecuación
\[
 $f $list_desig_tex[$index] $c
\]
$PAR
Contestación: \{ans_rule(20)\} \{ AnswerFormatHelp("intervals") \}
END_TEXT
Context()->normalStrings;

#Context("Numeric");
##############################################################
#  Answers
#

ANS( $answer->cmp() );

Context()->texStrings;
SOLUTION(EV3(<<'END_SOLUTION'));
$BBOLD Paso 1:$EBOLD Hallar los intervalos de prueba, resolviendo la ecuación \($f = $c\):
\[
 \begin{align*}
  $fa &= $c \quad \Rightarrow \quad x = $pt1 \\
  $fa &= -$c \quad \Rightarrow \quad x = $pt2,
 \end{align*}
\]
entonces los intervalos de prueba serán \( (-\infty,$val_cero[0]), ($val_cero[0],$val_cero[1]) \) y \( ($val_cero[1],\infty) \).
$PAR
$BBOLD Paso 2:$EBOLD Seleccionar un punto de prueba dentro de cada intervalo anterior para determinar el valor de verdad de la expresión \( $f $list_desig_tex[$index] $c \).
$PAR
\{
 BeginTable(border=>1, tex_border=>"1pt", spacing=>0, padding=>4).
 AlignedRow( [ "$BBOLD Intervalo$EBOLD", "$BBOLD Punto de Prueba$EBOLD", "$BBOLD Evaluar$EBOLD", "$BBOLD Valor de verdad$EBOLD"], align=>CENTER, separation=>0). 
 AlignedRow( [ "\( (-\infty,$val_cero[0]) \)", "\( $punto_prueba1 \)", 
"\[
\begin{align*}
 \left| $fa2pp1 + $b \right|  & $list_desig_tex[$index] $c \\
                                   $fpp1  & $list_desig_tex[$index] $c 
\end{align*}
\]", 
vverdad($fpp1,$c,$index) ], align=>CENTER, separation=>0).
 AlignedRow( [ "\( ($val_cero[0],$val_cero[1]) \)", "\( $punto_prueba2 \)", 
"\[
\begin{align*}
 \left| $fa2pp2 + $b \right|  & $list_desig_tex[$index] $c \\
                                   $fpp2  & $list_desig_tex[$index] $c 
\end{align*}
\]", 
vverdad($fpp2,$c,$index)  ], align=>CENTER, separation=>0).
 AlignedRow( [ "\( ($val_cero[1],\infty) \)", "\( $punto_prueba3 \)", 
"\[
\begin{align*}
 \left| $fa2pp3 + $b \right|  & $list_desig_tex[$index] $c \\
                                  $fpp3  & $list_desig_tex[$index] $c 
\end{align*}
\]",
vverdad($fpp3,$c,$index)  ], align=>CENTER, separation=>0).
EndTable()
\}
$PAR
Buscamos los valores de \(x\) que hagan el valor absoluto de la expresión \($list_desig_tex[$index] $c\). Basándonos en la tabla anterior, el conjunto solución es: \($answer\).
$paso_extra
END_SOLUTION
Context()->normalStrings;

ENDDOCUMENT();