# DESCRIPTION
# Problem from Business Calculus with Excel, Mike May, Anneke Bart
# WeBWorK problem written by Mike May, <mike.may@slu.edu>

## Author('Megan Nigg');
## DBsubject(Calculus - single variable)
## DBchapter(Rate of Change and Derivatives)
## DBsection(Numeric Derivatives and Limits)
## Institution(Saint Louis University)
## Level(2)
## MO(1)
## TitleText1('Business Calculus with Excel')
## AuthorText1('May')
## Chapter('3')
## Section('2').
## Problem('7')
## KEYWORDS('calculus','linear','functions')
DOCUMENT();

loadMacros(
"PGstandard.pl",
"MathObjects.pl",
"PGgraphmacros.pl",
"PGessaymacros.pl",
"PGchoicemacros.pl",
);

TEXT(beginproblem());

Context("Numeric");

$a = (2,5);

$x = random(1,5,1);

$fx= Compute("e^($a*x)")->reduce;
$fx1 = Compute("e^($a*(x+1))")->reduce;

$fxeval = $fx->eval(x=>$x);
$fx1eval = $fx1->eval(x=>$x);

$start = random(-.003,0.003,0.001);

$x1= Compute("$x+$start");
$x2 = Compute("$x1+0.001");
$x3 = Compute("$x2+0.001");

$fx1 = $fx->eval(x=>$x1);
$fx2 = $fx->eval(x=>$x2);
$fx3 = $fx->eval(x=>$x3);

$last = Compute("$x+0.005");
$first = Compute("$x-0.005");

$flast = $fx->eval(x=>$last);
$ffirst = $fx->eval(x=>$first);

$slope = Compute("($flast-$ffirst)/(10*0.001)");

$mf = Compute("$fx1-$fx");

$mfeval = Compute("$fx1eval-$fxeval");

BEGIN_TEXT

Use \(f(x)=e^{$a*x}\) at \(x=$x\).
$BR
$BR
a. Find a value of \(del\) \(x\) small enough that graph of the function looks like a straight line on the region from \(5*del\) \(x\) before the x-value to \(5*del\) \(x\) after the x-value. Graph the function in this region and find the slope of the corresponding secant line.
$BR
$BR
Let \(del\) \(x=0.001\) and fill in the missing data from the table.
$BR
\{ 
begintable(5) .
row( "x","f(x)") .
row( "$x1",ans_rule()) .
row( "$x2",ans_rule()) .
row( "$x3",ans_rule()) .
endtable(); 
\}
$BR
$BR
b. Estimate the derivative by finding the slope of the secant when \(del\) \(x\) takes the values 0.1, 0.01, 0.001, 0.0001, -0.1, -0.01, -0.001, and -0.0001. Give a value of the limit of the slope.
$BR
\(limit=\) \{ans_rule()\}
$BR
$BR
c. Use the calculator estimate to estimate the slope of the tangent.
$BR
\(f'(x)=\) \{ans_rule()\}
$BR
$BR
d. Find the corresponding value of the marginal function \(marginal\) \(f(x+1)\). 
$BR
\(Marginal\) \(f($x+1)=\) \{ans_rule\}

END_TEXT
Context()->normalStrings;

$showPartialCorrectAnswers = 1;

ANS( $fx1->cmp() );
ANS( $fx2->cmp() );
ANS( $fx3->cmp() );
ANS( $slope->cmp() );
ANS( $slope->cmp() );
ANS( $mfeval->cmp() );

Context()->texStrings;
BEGIN_SOLUTION
${PAR}SOLUTION:${PAR}

a. Your table should look like this:
$BR
\{ 
begintable(5) .
row( "x","f(x)") .
row( "$x1","$fx1") .
row( "$x2", "$fx2") .
row( "$x3", "$fx3") .
endtable(); 
\}
$BR
$BR

b. You can either change delx and record each of the slopes in the Excel sheet above, or we can set up another table that records the slopes for us. We prefer the second method because the table of values allows us to inspect the pattern more easily.
$BR
The limit is \($slope\).
$BR
$BR
c. So \(f'(x)\approx \frac{f($x+.001)-f($x-.001)}{.002}=$slope\)
$BR
$BR
d. 
$BR
$BCENTER
\(Marginal\) \(f(x+1)=f(x+1)-f(x)\).
$BR
\(Marginal\) \(f($x+1)=f($x+1)-f($x)=$mfeval\)

END_SOLUTION
Context()->normalStrings;

COMMENT('MathObject version.');

ENDDOCUMENT();