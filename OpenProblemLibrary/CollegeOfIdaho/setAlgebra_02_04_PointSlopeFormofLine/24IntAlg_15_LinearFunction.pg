##DESCRIPTION
## Slope-intercept form of a linear function

##ENDDESCRIPTION
## DBsubject(Algebra)
## DBchapter(Linear equations and functions)
## DBsection(Equations of lines: slope-intercept form)
## Institution(The College of Idaho)
## Author(RA Cruz)
## MLT(MLT13)
## Level(2)
## MO(1)
## TitleText1('Essentials of Intermediate Algebra')
## AuthorText1('Blitzer')
## EditionText1('1')
## Section1('2.4')
## Problem1('')
## KEYWORDS('linear function', 'slope-intercept form','lines')

DOCUMENT();

loadMacros(
    'PGstandard.pl',          'PGML.pl',
    'PGtikz.pl',              'contextLimitedNumeric.pl',
    'parserImplicitPlane.pl', 'PGcourse.pl'
);

@fraction = (1, 2, 1, 3, 1, 4, 2, 3, 3, 4, 3, 2, 1, 1, 2, 1, 3, 1, 4, 1);
$n        = random(0, 14, 2);
$dy       = $fraction[$n] * (-1)**random(1, 2, 1);
$dx       = $fraction[ $n + 1 ];
$m        = $dy / $dx;
$b        = random(-3, 3);
$f        = Formula("$m*x+$b");

# determine the bounds of the lines for nicer plotting

$xmax =
    $m * 7.5 + $b > 7.5    ? (7.5 - $b) / $m
    : $m * 7.5 + $b < -7.5 ? (-7.5 - $b) / $m
    :                        7.5;

$xmin =
    $m * -7.5 + $b > 7.5    ? (7.5 - $b) / $m
    : $m * -7.5 + $b < -7.5 ? (-7.5 - $b) / $m
    :                         -7.5;

$graph = createTikZImage();
$graph->tikzLibraries('arrows.meta');
$graph->BEGIN_TIKZ
\tikzset{>={Stealth[scale=1.5]}}
\filldraw[
    draw=LightBlue,
    fill=white,
    rounded corners=10pt,
    thick,use as bounding box
] (-8.5,-8.5) rectangle (8.5,8.5);
\draw[gray] (-7,-7) grid (7,7);
\draw[->,thick] (-7.5,0) -- (7.5,0) node[above left,outer sep=3pt] {\(x\)};
\foreach \x in {-7,...,-1,1,2,...,7}
    \draw(\x,5pt) -- (\x,-5pt) node [below] {\(\x\)};
\draw[->,thick] (0,-7.5) -- (0,7.5) node[below right,outer sep=3pt] {\(y\)};
\foreach \y in {-7,...,-1,1,2,...,7}
    \draw (5pt,\y) -- (-5pt,\y) node[left] {\(\y\)};
\draw[blue,ultra thick,<->] plot[domain=$xmin:$xmax] (\x,{$m*\x+$b});
END_TIKZ

Context("LimitedNumeric-Fraction");

Context()->strings->add(
    "Does not exist" => {},
    "Not defined"    => { alias => 'Does not exist' }
);

($rise, $run) = reduce($dy, $dx);
$m = Compute("$rise/$run");

Context("ImplicitPlane");
Context()->variables->are(x => "Real", y => "Real");

$eq     = ImplicitPlane("y=$m*x+$b");
$eq_cmp = $eq->cmp->withPostFilter(sub {
    my $ans = shift;
    if ($ans->{ans_message} =~ /left side|it looks like/) {
        $ans->{ans_message} =
            "Your answer must be an equation: $BR \(y = m x + b\) or \(ax + by = c\)";
    }
    return $ans;
});

#  Main text

BEGIN_PGML

>> [! alt text !]{$graph}{400} <<

Use the graph, given above, to find the slope and equation for the line.

a) Slope of the line: [` m =`] [_]{$m}

b) Equation of the line:  [_]{$eq_cmp}
END_PGML

$x0 = $dx;
$y0 = $b + $dy;

BEGIN_PGML_SOLUTION
First, you will need to find the slope of the line.  First, pick a point that is on grid.  Two nices points are [` (0,[$b])`] and [` ([$x0], [$y0]) `]. 

a) Slope:

    [``` m= \frac{\text{rise}}{\text{run}} = \frac{[$y0]-[$b]}{[$x0]-0} = \frac{[$dy]}{[$dx]} ```]

b) Equation:  Since the [`y`]-intercept is a nice point [`(0,[$b])`], the line is [`y=mx+b`] or 

[```y = \frac{[$dy]}{[$dx]} x + [$b]```]


END_PGML_SOLUTION

ENDDOCUMENT();
