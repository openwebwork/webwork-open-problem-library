# DESCRIPTION
# Problem from Calculus, multi-variable, Hughes-Hallett et al.,
# originally from 5ed (with updates)
# WeBWorK problem written by Gavin LaRose, <glarose@umich.edu>
## Tagged by glr 05/12/09

## DBsubject(Calculus - multivariable)
## DBchapter(Concepts for multivariable functions)
## DBsection(Traces, contours, and level sets)
## Institution(University of Michigan)
## Author(Gavin LaRose)
## Level(2)
## MO(1)
## TitleText1('Calculus')
## TitleText2('Calculus')
## TitleText3('Calculus')
## AuthorText1('Hughes-Hallett')
## AuthorText2('Hughes-Hallett')
## AuthorText3('Hughes-Hallett')
## EditionText1('5')
## EditionText2('6')
## EditionText3('7')
## Section1('12.4')
## Section2('12.4')
## Section3('12.4')
## Problem1('15')
## Problem2('15')
## Problem3('15')
## KEYWORDS('linear', 'functions', 'multivariable', 'plane')

## Textbook tags
## HHChapter1('Functions of Several Variables')

DOCUMENT();

loadMacros('PGstandard.pl', 'PGML.pl', 'plots.pl', 'PGcourse.pl');

## the cost of a cd
$p = random(6, 10, 2);
## the cost of a dvd
$q = $p + random(2, 6, 2);

## then the revenue is given by
##    r = p c + q d,
## so the contour lines are the lines
##    d = r/q - (p/q) c

$plot = Plot(
    xmin        => 0,
    xmax        => 400,
    ymin        => 0,
    ymax        => 400,
    xtick_delta => 100,
    xminor      => 1,
    ytick_delta => 100,
    yminor      => 1,
    xlabel      => '\(c\)',
    ylabel      => '\(d\)',
    aria_label  => 'The revenue based on number of CDs and DVDs sold',
    axes_on_top => 1,
);

for ($i = 1; $i < 9; $i++) {
    $r = 1000 * $i;
    $plot->add_function(
        "($r - $p*x)/($q)", 'x', 0, $r / $p,
        color  => 'blue',
        weight => 2
    );
    $y1 = $r / ($p + $q);
    $plot->add_label($y1 + 20, $y1 + 10, label => "$r", color => 'blue');
}

## nice intersection points are given by
%rpoints = (
    6 => {
        8  => [ [ 200, 100, 2000 ], [ 100, 300, 3000 ] ],
        10 => [ [ 250, 50,  2000 ], [ 250, 150, 3000 ] ],
        12 => [ [ 100, 200, 3000 ], [ 200, 150, 3000 ] ]
    },
    8 => {
        10 => [ [ 250, 100, 3000 ], [ 250, 200, 4000 ] ],
        12 => [ [ 100, 100, 2000 ], [ 100, 350, 5000 ] ],
        14 => [ [ 200, 100, 3000 ], [ 100, 300, 5000 ] ]
    },
    10 => {
        12 => [ [ 100, 250, 4000 ], [ 200, 250, 5000 ] ],
        14 => [ [ 150, 250, 5000 ], [ 250, 250, 6000 ] ],
        16 => [ [ 100, 250, 5000 ], [ 200, 250, 6000 ] ]
    }
);

($c0, $d0, $r0) = @{ $rpoints{$p}->{$q}->[0] };
($c1, $d1, $r1) = @{ $rpoints{$p}->{$q}->[1] };

$alt_text =
    "A graph where the horizontal axis is labelled as c, and the vertical axis is labelled as d.  On the graph are eight parallel horizontal lines starting at the vertical axis and travelling down and right until they meet the horizontal axis.  The lowest such line is labelled with 1000, and each higher line has a label that is 1000 greater than the one below. The line that is labelled $r0 passes through the point ($c0,$d0).  The line that is labelled $r1 passes through the point ($c1,$d1).";

BEGIN_PGML
A store sells CDs at one price and DVDs at another
price.  The figure below shows the revenue (in dollars)
of the music store as a function of the number, [` c `],
of CDs and the number, [` d `], of DVDs that it sells.  The
values of the revenue are shown on each line.

>> [! $alt_text !]{$plot}{300} <<

_(Hint: for this problem there are many possible ways to
estimate the requisite values; you should be able to find information
from the figure that allows you to give an answer that is essentially
exact.)_

a) What is the price of a CD? [_]{$p}{5} dollars
b) What is the price of a DVD? [_]{$q}{5} dollars
END_PGML

BEGIN_PGML_SOLUTION
The revenue function, [`R`], is linear and so we may write it as:
[```
R = (p_1)c + (p_2)d
```]
where [`p_1`] is the price of CDs and [`p_2`] is the price of DVDs, in
dollars.
From the diagram, we can pick two points, such as [`c = [$c0]`], [`d=[$d0]`]
on the contour [`R=[$r0]`], and [`c = [$c1]`], [`d = [$d1]`] on the contour
[`R = [$r1]`].  These
points give the following system of linear equations:
[```
[$r0] = [$c0] p_1 + [$d0] p_2, \mbox{ and }
[$r1] = [$c1] p_1 + [$d1] p_2.
```]
Solving gives [`p_1 = [$p]`] dollars and [`p_2 = [$q]`] dollars.
END_PGML_SOLUTION

ENDDOCUMENT();
