# DESCRIPTION
# Problem from Calculus, multi-variable, Hughes-Hallett et al.,
# originally from 5ed (with updates)
# WeBWorK problem written by Gavin LaRose, <glarose@umich.edu>

## Tagged by glr 01/11/10


## DBsubject(Calculus - multivariable)
## DBchapter(Differentiation of multivariable functions)
## DBsection(Differentiability, linearization and tangent planes)
## Institution(University of Michigan)
## Author(Gavin LaRose)
## MLT(quadapprox)
## Level(2)
## MO(1)
## TitleText1('Calculus')
## TitleText2('Calculus')
## TitleText3('Calculus')
## AuthorText1('Hughes-Hallett')
## AuthorText2('Hughes-Hallett')
## AuthorText3('Hughes-Hallett')
## EditionText1('5')
## EditionText2('6')
## EditionText3('7')
## Section1('14.7')
## Section2('14.7')
## Section3('14.7')
## Problem1('34')
## Problem2('36')
## Problem3('44')
## KEYWORDS('chain rule', 'multivariable', 'functions', 'calculus', 'derivatives', 'second derivative')

## Textbook tags
## HHChapter1('Differentiating Functions of Several Variables')

DOCUMENT();

loadMacros(
  "PGstandard.pl",
  "PGchoicemacros.pl",
  "MathObjects.pl",
  "PGcourse.pl"
);

Context("Numeric");
Context()->variables->add( y=>'Real' );
$showPartialCorrectAnswers = 1;

$a = random(1,5,1);
$dx = list_random( -0.3, -0.2, -0.1, 0.1, 0.2, 0.3 );
$dy = list_random( -0.3, -0.2, -0.1, 0.1, 0.2, 0.3 );
$whichf = random(0,1,1);

if ( $whichf ) {
    $func = Compute("sin(x - $a)*cos(y)");
    $x0 = $a;
    $y0 = 0;
} else {
    $func = Compute("cos(x)*sin(y - $a)");
    $x0 = 0;
    $y0 = $a;
}

$f0 = $func->substitute( x=>$x0, y=>$y0 );
$fx = $func->D('x');  $fx0 = $fx->substitute( x=>$x0, y=>$y0 );
$fy = $func->D('y');  $fy0 = $fy->substitute( x=>$x0, y=>$y0 );
$fxx = $fx->D('x');  $fxx0 = $fxx->substitute( x=>$x0, y=>$y0 );
$fyy = $fy->D('y');  $fyy0 = $fyy->substitute( x=>$x0, y=>$y0 );
$fxy = $fx->D('y');  $fxy0 = $fxy->substitute( x=>$x0, y=>$y0 );

$lin  = Compute( "$f0 + $fx0*(x-$x0) + $fy0*(y-$y0)" )->reduce();
$quad = Compute( "$f0 + $fx0*(x-$x0) + $fy0*(y-$y0) + $fxx0*(x-$x0)^2/2 + " .
	         "$fyy0*(y-$y0)^2/2 + $fxy0*(x-$x0)*(y-$y0)" )->reduce();

$x1 = $x0 + $dx;
$y1 = $y0 + $dy;

$lin1  = $lin->eval( x=>$x1, y=>$y1 );
$quad1 = $quad->eval( x=>$x1, y=>$y1 );
$func1 = $func->eval( x=>$x1, y=>$y1 );

Context()->texStrings;
TEXT(beginproblem());
BEGIN_TEXT
$dx/$dy $PAR

Find the linear, \( L(x,y) \), and quadratic, \( Q(x,y) \),
Taylor polynomials valid near \( ($x0,$y0) \) for
\[ f(x,y) = $func.\]

\( L(x,y) = \) \{ ans_rule(55) \} $BR
\( Q(x,y) = \) \{ ans_rule(55) \}

$PAR
Find the approximations for \(f($x1,$y1)\) generated by these, and
compare with the exact value of the function:
$BR
At \(($x1,$y1)\),$BR
\( L($x1,$y1) = \) \{ ans_rule(25) \}, $BR
\( Q($x1,$y1) = \) \{ ans_rule(25) \}, $BR
\( f($x1,$y1) = \) \{ ans_rule(25) \}.

END_TEXT
Context()->normalStrings;

ANS($lin->cmp() );
ANS($quad->cmp() );
ANS($lin1->cmp() );
ANS($quad1->cmp() );
ANS($func1->cmp() );

Context()->texStrings;
SOLUTION(EV3(<<'END_SOLUTION'));
$PAR SOLUTION $PAR

We have \(f($x0,$y0) = $f0\) and the relevant derivatives are:
\[
f_x = $fx\quad\mbox{so}\quad f_x($x0,$y0) = $fx0,
\]
\[
f_y = $fy\quad\mbox{so}\quad f_y($x0,$y0) = $fy0,
\]
\[
f_{xx} = $fxx\quad\mbox{so}\quad f_{xx}($x0,$y0) = $fxx0,
\]
\[
f_{xy} = $fxy \quad\mbox{so}\quad f_{xy}($x0,$y0) = $fxy0,
\]
and
\[
f_{yy} = $fyy\quad\mbox{so}\quad f_{yy}($x0,$y0) = $fyy0.
\]
Thus the linear approximation, \(L(x,y)\) to \(f(x,y)\) at
\(($x0,$y0)\), is given by:
\[
f(x,y)\approx L(x,y) = f($x0,$y0)+f_x($x0,$y0)(x-$x0)+f_y($x0,$y0)(y-$y0)
= $lin
\]

The quadratic approximation, \(Q(x,y)\) to \(f(x,y)\) near
\(($x0,$y0)\), is given by:
\[
f(x,y)\approx Q(x,y) = f($x0,$y0)+f_x($x0,$y0)(x-$x0)+f_y($x0,$y0)(y-$y0) +
  {1\over 2}f_{xx}($x0,$y0)(x-$x0)^2
\]
\[ + f_{xy}($x0,$y0)(x-$x0)(y-$y0)+{1\over 2}f_{yy}($x0,$y0)(y-$y0)^2 \]
\[ = $quad \]

Thus the linear and quadratic approximations are the same.  The values
of the approximations are
\[
L($x1,$y1) = Q($x1,$y1) = $lin1.
\]
and the exact value is
\[
f($x1,$y1) = $func1.
\]

END_SOLUTION
Context()->normalStrings;


;
ENDDOCUMENT();
