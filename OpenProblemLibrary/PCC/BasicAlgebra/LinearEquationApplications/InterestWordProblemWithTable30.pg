# WeBWorK problem written by Carl Yao, 2013
# Portland Community College
#
# Write an one-variable linear equation to solve interest word problems.
# A table is available to help organize data.
#
# Last updated: Jordan 8/28/13; Yao, 7/28/13
# ENDDESCRIPTION

## DBsubject('Algebra')
## DBchapter('Basic Algebra')
## DBsection('Problem Solving with Equations')
## KEYWORDS('equation','solve','word problem','interest')
## DBCCSS('7.EE.3','8.EE.7','A-CED.1')
## TitleText1('')
## EditionText1('')
## AuthorText1('')
## Section1('')
## Problem1('')
## Author('Alex Jordan, Carl Yao, Chris Hughes')
## Institution('PCC')
 
##############################################

DOCUMENT();

loadMacros(
  "PGstandard.pl",
  "MathObjects.pl",
  "contextCurrency.pl",
  "pccTables.pl",
  "PGML.pl",
  "PCCmacros.pl",
  "answerHints.pl",
  "PGcourse.pl",
);

##############################################

Context("Currency");
Context()->currency->addSymbol("dollars","dollar");
Context()->flags->set(trimTrailingZeros=>1);
#Context()->operators->undefine('+','-');

$rInit= random(5000,9000,500);
$cInit = Currency($rInit);
$p1 = random(1,9,2);
$p2 = random(2,8,2);
$dp1 = $p1/100;
$dp2 = $p2/100;
$rFund1 = random(2000,4500,500);
$rFund2 = $rInit-$rFund1;
$cFund1 = Currency($rFund1);
$cFund2 = Currency($rFund2);

$rTotalInt = $rFund1*$dp1+$rFund2*$dp2;
$cTotalInt = Currency($rTotalInt);

$sex = list_random('male','female');
$pronoun = 'he' if ($sex eq 'male');
$pronoun = 'she' if ($sex eq 'female');

$name = RandomName(sex=>$sex);

##############################################
TEXT(beginproblem());


BEGIN_PGML

[$name] invested [`[$cInit]`] in two accounts. At the end of a year, one account had made a [`[$p1]%`] gain, and the other had made a [`[$p2]%`] gain. All together, [$name] made [`[$cTotalInt]`] in interest. How much money did [$name] invest in each account? The table below may help you organize information before you write an equation.

If we let [`x`] be the amount of money invested in the [`[$p1]%`] account...
END_PGML
Context()->texStrings;
BEGIN_TEXT
$PAR
\{ 
DataTable([[{data=>"",header=>"CH"},{data=>"Rate",header=>"CH"},{data=>" \(\times\)",header=>"CH"},{data=>"Principal",header=>"CH"},{data=>"\(=\)",header=>"CH"},{data=>"Interest",header=>"CH"},],
[{data=>"\($p1%\) Investment",header=>"RH"},"\($dp1\)","$SPACE","\(x\)","$SPACE","\($dp1 x\)"],
[{data=>"\($p2%\) Investment",header=>"RH"},"\($dp2\)","$SPACE","\($rInit-x\)","$SPACE","\($dp2($rInit-x)\)"],
], allcellcss=>"border:1px solid;padding:4pt;text-align:center;", caption => "Organize data with a table", captioncss =>"padding:4pt; text-decoration:none;");
\}  

$PAR
END_TEXT
Context()->normalStrings;

BEGIN_PGML

    According to the table, the total interest that [$name] earned is [_______________] dollars.

Now set up and solve an equation to find how much [$name] invested in each account.

    [$name] invested [_______] at [`[$p1]%`] and [_______] at [`[$p2]%`].



END_PGML

ANS(Compute("$dp1*x+ $dp2*($rInit-x)") -> cmp() ->withPostFilter(AnswerHints( 
  Compute($rTotalInt) => "Give the total interest _according to the table_, not according to the problem introduction"
)));

ANS( Compute($cFund1) -> cmp);
ANS( Compute($cFund2) -> cmp);


##############################################
$showPartialCorrectAnswers=1;

$s1=$dp2*$rInit;
$s2=$dp1-$dp2;
$s3=$rTotalInt-$s1;


BEGIN_SOLUTION
$PAR
If we let \(x\) represent the number of dollars that $name invested in the \($p1%\) account, then $pronoun  must have invested \($rInit -x\) dollars in the \($p2%\) account.
$PAR
So $name  earned \($dp1  x\) dollars of interest from the \($p1%\) account, and \($dp2  ($rInit -x)\) dollars of interest from the \($p2%\) account.

$PAR
We can organize the quantities (interest rate, principal investment, and interest amount) for the two accounts into the table:
$PAR
\{ 
DataTable([[{data=>"",header=>"CH"},{data=>"Rate",header=>"CH"},{data=>" \(\times\)",header=>"CH"},{data=>"Principal",header=>"CH"},{data=>"\(=\)",header=>"CH"},{data=>"Interest",header=>"CH"},],
["\($p1%\) Investment","\($dp1\)","$SPACE","\(x\)","$SPACE","\($dp1 x\)"],
["\($p2%\) Investment","\($dp2\)","$SPACE","\($rInit-x\)","$SPACE","\($dp2($rInit-x)\)"],
["Total","---","$SPACE","\($rInit\)","$SPACE","\($dp1 x+$dp2($rInit-x)\)"],
], allcellcss=>"border:1px solid;padding:4pt;text-align:center;", caption => "Organize data with a table", captioncss =>"padding:4pt; text-decoration:none;");
\}  

$PAR
The table tells us that $name earned a total of \($dp1 x+ $dp2($rInit-x)\) dollars in interest. The introduction tells us that $pronoun earned \($cTotalInt\) in interest. Now we can write an equation and then solve it:
$PAR
\[
\begin{aligned}
  $dp1  x + $dp2  ($rInit -x) & = $rTotalInt  \\
  $dp1  x + $dp2  \cdot $rInit -$dp2 x & = $rTotalInt  \\
  $dp1  x + $s1 -$dp2 x & = $rTotalInt  \\
  $s2  x + $s1  & = $rTotalInt  \\
  $s2  x + $s1 \mathbf{{}-$s1}  & = $rTotalInt \mathbf{{}-$s1}  \\
  $s2 x          & = $s3  \\
  \frac{$s2 x}{$s2 } & = \frac{$s3 }{$s2 } \\
  x               & = $rFund1 
\end{aligned}
\]
$PAR
So $name invested \($cFund1 \) in the \($p1%\) account, and $pronoun  must have invested \($cInit -$cFund1\), or \($cFund2 \) dollars in the \($p2%\) account.

END_SOLUTION

ENDDOCUMENT();
