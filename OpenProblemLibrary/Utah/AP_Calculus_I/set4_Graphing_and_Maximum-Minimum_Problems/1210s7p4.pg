##DESCRIPTION
# Validate mean value theorem in special cases
##ENDDESCRIPTION
## DBsubject(Calculus - single variable)
## DBchapter(Applications of differentiation)
## DBsection(Mean value theorem)
## Institution(Univeristy of Utah)
## Author(Utah ww group)
## MLT(MVT_Poly_Type_1)
## Level(3)
## TitleText1('Calculus I')
## AuthorText1('Jerrold Marsden and Alan Weinstein')
## EditionText1('2')
## Section1('Graphing_and_Maximum-Minimum_Problems')
## Problem1('')
## TitleText2('Calculus')
## AuthorText2('Dale Varberg, Edwin J. Purcell, and Steven E. Rigdon')
## EditionText2('9')
## Section2('Applications of the Derivative')
## Problem2('')
## KEYWORDS('calculus')

DOCUMENT();        # This should be the first executable line in the problem.

loadMacros("PG.pl",
           "PGbasicmacros.pl",
           "PGchoicemacros.pl",
           "PGanswermacros.pl",
"PGauxiliaryFunctions.pl");

TEXT(beginproblem());
$showPartialCorrectAnswers=1;

sub f1 {
		my $x = shift;
		$A3*$x**3 + $A2*$x**2 + $A1*$x +$A0;
		}
$discrim = 0;

while ($discrim == 0  || $A3 == 1 || $A2 == 1 || $A1 == 1 || $A0 == 1
|| $A3 == -1 || $A2 == -1 || $A1 == -1 || $A0 == -1) {
	$A3=  random(1,3,1)*(random(0,1,1) ? 1: -1);
	$A2 = non_zero_random(-4,4,1);
	$A1 = non_zero_random(-4,4,1);
	$A0 = non_zero_random( -4 ,4,1);
	$left = random(-4,4,1);
	$right = $left + random (1,8,1);

	$avg = (f1($right) - f1($left) ) /($right - $left);
	$a= 3*$A3;
	$b=2*$A2;
	$c = $A1 - $avg;
	$discrim = $b**2 - 4*$a*$c;
	}

$root1 = ( -$b - sqrt($discrim) ) /(2*$a);
$root2 = ( -$b + sqrt($discrim) ) /(2*$a);
TEXT(EV2(<<EOT));
Consider the function
\[ f(x) = !{$A3}x^3 ? {$A2}x^2 ? {$A1}x ? {$A0} \]
Find the average slope of this function on the interval \( ( $left , $right ) \).
\{ans_rule(20) \} $BR
EOT

if ($left<= $root1 and $root1 <= $right and $left < $root2 and $root2 <= $right) { # both roots are in interval)
	TEXT(EV2(<<EOT));
By the Mean Value Theorem, we know there exists a \( c \) in the open interval
\( ( $left, $right ) \) such that \( f'(c) \) is equal to this mean slope.
Find the two values of \( c \) in the interval which work, enter the smaller root first:

\{ ans_rule(10) \}\(  $LTE \)  \{ ans_rule(10) \}
EOT

    ANS(num_cmp([$avg,num_sort($root1, $root2)], relTol=>.1));
    }
elsif ($left<$root1 and $root1<$right ) { #root 1 is in the interval
	TEXT(EV2(<<EOT));
By the Mean Value Theorem, we know there exists a \( c \) in the open interval
\( ( $left, $right ) \) such that \( f'(c) \) is equal to this mean slope.
Find the  value of \( c \) in the interval which works:
\{ ans_rule(10) \}
EOT
	ANS(num_cmp([$avg,$root1], relTol=>.1));
	}
elsif ($left<$root2 and $root2<$right ) { #root 1 is in the interval
	TEXT(EV2(<<EOT));
By the Mean Value Theorem, we know there exists a \( c \) in the open interval
\( ( $left, $right ) \) such that \( f'(c) \) is equal to this mean slope.
Find the  value of \( c \) in the interval which works
\{ ans_rule(10) \}
EOT
	ANS(num_cmp([$avg,$root2], relTol=>.1));
	}
else  {
	TEXT("Error in formulating problem -- inform instructor please.");
	}

ENDDOCUMENT();        # This should be the last executable line in the problem.
