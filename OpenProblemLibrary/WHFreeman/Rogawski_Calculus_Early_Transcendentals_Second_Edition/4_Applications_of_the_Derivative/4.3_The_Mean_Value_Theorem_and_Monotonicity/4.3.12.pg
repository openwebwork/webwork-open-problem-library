## DBsubject(Calculus - single variable)
## DBchapter(Applications of differentiation)
## DBsection(Increasing/decreasing functions and local extrema)
## Institution(W.H.Freeman)
## Author(Ned W. Hummel)
## MLT(graph_of_fprime)
## MLTleader(1)
## Level(3)
## MO(1)
## TitleText1('Calculus: Early Transcendentals')
## AuthorText1('Rogawski')
## EditionText1('2')
## Section1('4.3')
## Problem1('12')
## KEYWORDS('calculus','derivatives','first derivative test','critical points', 'local maximum/minimum')

DOCUMENT();

loadMacros(
  "PGstandard.pl",
  "Parser.pl",
  "freemanMacros.pl",
  "PGgraphmacros.pl",
  "PGchoicemacros.pl",
  "PGcourse.pl"
);


# This is our macro file that provides the textbook_ref_exact() and


TEXT(beginproblem());


@label_increase_decrease = qw(? Increasing Decreasing);
################# Setting up the problem goes here.
### Book
# $a = random(-1,-1,1);
# $b = random(2,2,1);
# $c = random(4,4,1);
# $d = random(6,6,1);

$a = non_zero_random(-1,1,1);
$b = random(1,3,1);
$c = random($b+1,6,1);
$d = random($c+1,8,1);


$f = Formula("$a*x(x-$b)(x-$c)(x-$d)");

$int1 = Interval('(',0,$b,')');
$int2 = Interval('(',$b,$c,')');
$int3 = Interval('(',$c,$d,')');

$realsmall = Real(0.1);

$int1_sign = Real(sgn($f->eval(x=>random($realsmall,$b-$realsmall))));
$int2_sign = Real(sgn($f->eval(x=>random($b+$realsmall,$c-$realsmall))));
$int3_sign = Real(sgn($f->eval(x=>random($c+$realsmall,$d-$realsmall))));

if($int1_sign > 0){
$int1_increase = "Increasing";
$s="\gt";
}
else{
$int1_increase = "Decreasing";
$s="\lt";
}

if($int2_sign > 0){
$int2_increase = "Increasing";
$s1="\gt";
}
else{
$int2_increase = "Decreasing";
$s1="\lt";
}

if($int3_sign > 0){
$int3_increase = "Increasing";
$s2="\gt";
}
else{
$int3_increase = "Decreasing";
$s2="\lt";
}


@vals_f = map {$f-> substitute(x=>$_)->eval()} (0..$d);

# Minimum and maximum x and y values to graph.
$xmin = -1;
$ymin = -max(abs(max(@vals_f)),abs(min(@vals_f)))-1;
$xmax = $d;
$ymax = max(abs(max(@vals_f)),abs(min(@vals_f)))+1;

$xrange = $xmax-$xmin;
$yrange = $ymax-$ymin;

$xsize = $xrange*25;
$ysize = $yrange*25;

$graph = init_graph(
    $xmin, $ymin,
    $xmax, $ymax,
    grid => [$xrange,20], # was [$xrange,$yrange]
    axes => [0,0],
);

$f_graph = "$f for x in [0,$d] using color:red and weight:2";
plot_functions($graph,$f_graph);


Context()->texStrings;

BEGIN_TEXT
\{ textbook_ref_exact("Rogawski ET 2e", "4.3","12") \}
$PAR
Determine the intervals on which \(f\) is increasing or decreasing, assuming the figure below is the graph of the derivative of \(f\).
$PAR
\{ image(insertGraph($graph)) \}
$PAR
On Interval 1: \{ans_rule()\} \(\quad f\) is \{pop_up_list([@label_increase_decrease]) \}
$PAR
On Interval 2: \{ans_rule()\} \(\quad f\) is \{pop_up_list([@label_increase_decrease]) \}
$PAR
On Interval 3: \{ans_rule()\} \(\quad f\) is \{pop_up_list([@label_increase_decrease]) \}
END_TEXT

######################## Answer starts here.

Context()->normalStrings;

ANS($int1->cmp);
ANS(str_cmp($int1_increase));
ANS($int2->cmp);
ANS(str_cmp($int2_increase));
ANS($int3->cmp);
ANS(str_cmp($int3_increase));

Context()->texStrings;

SOLUTION(EV3(<<'END_SOLUTION'));
$PAR
$SOL

\(f(x)\) is increasing on 
every interval \((a,b)\)  over which \(f'(x)>0\), 
and is decreasing on 
every interval over which \(f'(x)<0\).  

If the graph of \(f'(x)\) is given in the above Figure, 
then \(f(x)\) is

$BR
$int1_increase on \(\{$int1->TeX\}\) as \(f'(x) $s 0 \) on  \(\{$int1->TeX\}\)
$BR 
$int2_increase on \(\{$int2->TeX\}\) as \(f'(x) $s1 0 \) on  \(\{$int2->TeX\}\)
$BR 
$int3_increase on \(\{$int3->TeX\}\) as \(f'(x) $s2 0 \) on  \(\{$int3->TeX\}\)




END_SOLUTION


ENDDOCUMENT();
