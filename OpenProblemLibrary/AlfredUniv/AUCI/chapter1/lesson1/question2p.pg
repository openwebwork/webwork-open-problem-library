## DESCRIPTION
## Problem from Functions Modeling Change, Connally, et al., 3rd ed.
## WeBWorK problem written by Adam Spiegler <aspiegler@luc.edu>
## ENDDESCRIPTION

## DBsubject('Precalculus')
## DBchapter('Linear Functions and Change')
## DBsection('Rate of Change')
## KEYWORDS('functions','average rate of change','rate of change')
## TitleText1('Functions Modeling Change')
## EditionText1('3')
## AuthorText1('Connally')
## Section1('1.2')
## Problem1('25')
## Author('Adam Spiegler')
## Institution('Loyola University Chicago')


DOCUMENT();       

loadMacros("PG.pl",
           "PGbasicmacros.pl",
           "PGchoicemacros.pl",
           "PGanswermacros.pl",
           "PGgraphmacros.pl",
           "PGauxiliaryFunctions.pl",
           "PGgraphmacros.pl"
           );
       
TEXT(beginproblem()); # standard preamble to each problem.


$showPartialCorrectAnswers = 1;

for ($j = 1; $j <= 12; $j++) { $depth[$j-1] = 25*$j };
@temp = ("5.50","5.20","5.10","5.10","5.30","5.50",
         "5.75","6.00","6.25","6.50","6.75","7.00");
@step = (50, 75, 100, 125, 150);
@pick_start = NchooseK(5,3);
@pick_dx = NchooseK(5,3);

if ($pick_start[2] == 0 && $pick_dx[2] == 3 ) {$pick_dx[2] = random(0,2,1)};

for ($k = 0; $k <= 2; $k++) {$x_start[$k] = $depth[$pick_start[$k]];
               $dx[$k] = $step[$pick_dx[$k]];
               $x_end[$k] = $x_start[$k] + $dx[$k];
               $f_start[$k] = $temp[$pick_start[$k]];
               $f_end[$k] = $temp[$pick_start[$k] + $dx[$k]/25];
               $df[$k] = $f_end[$k]-$f_start[$k];
               $rate[$k] = "$df[$k]/$dx[$k]";
               $disp[$k] = round($df[$k]/$dx[$k]*10000)/10000 };
 

##################################################


$checkbox_mc = new_checkbox_multiple_choice();

$checkbox_mc -> qa(
    "Which of the statements below CORRECTLY explains the significance of your 
        answer to part (c)?  Select ALL that apply (more than one may apply).",
    "Over the interval from $x_start[2] meters to $x_end[2] meters, the 
        temperature changes on average at a rate of $disp[2] degrees Celsius 
        per meter." );

$checkbox_mc -> extra(
       "$disp[2] is the slope of the graph of at $BITALIC d $EITALIC 
            = $x_start[2].",
       "The temperature changes by a total of $disp[2] degrees Celsius when 
           moving from a depth $x_start[2] meters to $x_end[2] meters.",
       "On average, the temperature is changing at a rate of $disp[2] degrees 
           Celsius per minute over the interval 
           \( $x_start[2] \leq d \leq $x_end[2] \) .",
       "The temperature is changing at a rate of $disp[2] degrees Celsius per 
           minute when the depth is $x_start[2] meters." );
$checkbox_mc -> makeLast("None of the above");


BEGIN_TEXT

$BR $SPACE $BR
The table below gives the average temperature, $BITALIC T${EITALIC}, at a depth $BITALIC d${EITALIC}, in a borehole in Belleterre, Quebec.
$BR $SPACE $BR
$BCENTER
\{ begintable(2) \}
\{ row( "\( d \mbox{, depth} \  (m) \)", "\( T \mbox{, temp} \ \left( C^{\circ} \right) \)" ) \}
\{ row( $depth[0] , $temp[0] ) \}
\{ row( $depth[1] , $temp[1] ) \}
\{ row( $depth[2] , $temp[2] ) \}
\{ row( $depth[3] , $temp[3] ) \}
\{ row( $depth[4] , $temp[4] ) \}
\{ row( $depth[5] , $temp[5] ) \}
\{ row( $depth[6] , $temp[6] ) \}
\{ row( $depth[7] , $temp[7] ) \}
\{ row( $depth[8] , $temp[8] ) \}
\{ row( $depth[9] , $temp[9] ) \}
\{ row( $depth[10] , $temp[10] ) \}
\{ row( $depth[11] , $temp[11] ) \}
\{ endtable () \}
$ECENTER
$BR $SPACE $BR
Evaluate \( \triangle T / \triangle d \) $SPACE on the following intervals 
$BR $SPACE $BR
a) \( $x_start[0] \leq d \leq $x_end[0] \) $SPACE $SPACE \( \triangle T / \triangle d \) = \{ ans_rule(30) \}
$BR $SPACE $BR
b) \( $x_start[1] \leq d \leq $x_end[1] \) $SPACE $SPACE \( \triangle T / \triangle d \) = \{ ans_rule(30) \}
$BR $SPACE $BR
c) \( $x_start[2] \leq d \leq $x_end[2] \) $SPACE $SPACE \( \triangle T / \triangle d \) = \{ ans_rule(30) \}
$BR $SPACE $BR
d) \{ $checkbox_mc -> print_q \} $BR
   \{ $checkbox_mc -> print_a \}

END_TEXT


ANS(num_cmp( $rate[0] ) );
ANS(num_cmp( $rate[1] ) );
ANS(num_cmp( $rate[2] ) );
ANS(checkbox_cmp( $checkbox_mc -> correct_ans ));

#########################################################

SOLUTION(EV3(<<'END_SOLUTION'));
$BR $SPACE $BR
$BBOLD SOLUTION $EBOLD
$BR
a) Over the interval $SPACE \( d  = $x_start[0] \) $SPACE to $SPACE \( d = $x_end[0] \), $SPACE $SPACE \( \triangle T = $f_end[0] - $f_start[0] = $df[0] \) $SPACE and $SPACE \( \triangle d = $x_end[0] - $x_start[0] = $dx[0] \) .  $BR
$SPACE $SPACE $SPACE Thus $SPACE \( \triangle T / \triangle d = $rate[0] \) .  $BR $SPACE $BR
b) Over the interval $SPACE \( d  = $x_start[1] \) $SPACE to $SPACE \( d = $x_end[1] \), $SPACE $SPACE \( \triangle T = $f_end[1] - $f_start[1] = $df[1] \) $SPACE and $SPACE \( \triangle d = $x_end[1] - $x_start[1] = $dx[1] \) .  $BR
$SPACE $SPACE $SPACE Thus $SPACE \( \triangle T / \triangle d = $rate[1] \) .  $BR $SPACE $BR
c) Over the interval $SPACE \( d  = $x_start[2] \) $SPACE to $SPACE \( d = $x_end[2] \), $SPACE $SPACE \( \triangle T = $f_end[2] - $f_start[2] = $df[2] \) $SPACE and $SPACE \( \triangle d = $x_end[2] - $x_start[2] = $dx[2] \) .  $BR
$SPACE $SPACE $SPACE Thus $SPACE \( \triangle T / \triangle d = $rate[2] \) .  $BR $SPACE $BR
d)  Only the statement $BITALIC Over the interval from $x_start[2] meters to $x_end[2] meters, the temperature changes on average at a rate of $disp[2] degrees Celsius per meter $EITALIC is correct.  All others are incorrect:
$BR $SPACE $BR
The statement, $disp[2] is the slope of the graph of at $BITALIC d $EITALIC = $x_start[2], is incorrect since the average rate of change is the slope of the line segment connect the endpoints of the interval. 
$BR
The statement, The temperature changes by a total of $disp[2] degrees Celsius when moving from a depth $x_start[2] meters to $x_end[2] meters, is incorrect since the average rate of change is a ratio of the change in temperature divided by the change in depth (not just the total change in temperature.
$BR
The statement, On average the temperature is changing at a rate of $disp[2] degrees Celsius per minute over the interval \( $x_start[2] \leq d \leq $x_end[2] \), is incorrect since the units must be degrees Celsius per meter (not minute).
$BR
The statement, The temperature is changing at a rate of $disp[2] degrees Celsius per minute when the depth is $x_start[2] meters, is incorrect since the average rate of change averages the rates of change at every point in the interval.  It is not the rate of the change at just the initial depth.
$BR
END_SOLUTION

      
ENDDOCUMENT();   # This should be the last executable line in the problem.