# DESCRIPTION
# Problem from Functions Modeling Change, Connally et al., 3rd ed.
# WeBWorK problem written by Adam Spiegler, <aspiegler@luc.edu>
# LoyolaChicago/Precalc/Chap3Sec4/Q23.pg
# ENDDESCRIPTION

## DBsubject('Precalculus')
## DBchapter('Exponential Functions')
## DBsection('Continuous Growth and the Number e')
## KEYWORDS('exponential functions','continuous growth','natural base','e')
## TitleText1('Functions Modeling Change')
## EditionText1('3')
## AuthorText1('Connally')
## Section1('3.4')
## Problem1('23')
## TitleText2('Functions Modeling Change');
## EditionText2('4')
## AuthorText2('Connally')
## Section2('4.5')
## Problem2('48')
## Author('Adam Spiegler and Paul Pearson')
## Institution('Loyola University Chicago and Fort Lewis College')

DOCUMENT();

loadMacros("PG.pl",
           "PGbasicmacros.pl",
#           "PGchoicemacros.pl",
           "PGanswermacros.pl",
           "PGgraphmacros.pl",
#           "extraAnswerEvaluators.pl",
           "PGauxiliaryFunctions.pl",
"MathObjects.pl",
"AnswerFormatHelp.pl",
"PGcourse.pl",
           );

TEXT(beginproblem());

Context("Numeric")->variables->are(t=>"Real");

$showPartialCorrectAnswers = 1;

$p = 77.2;
$r = 1.6;
$k = $r/100;
$ans_a = "$p exp($k t)";

$year = random(2011,2016,1);
$t = $year - 2004;
$ans_b = round($p*exp($k*$t)*1000)/1000;

$low = round($ans_b/10)*10+5;
$high = $low+10;
$amt = random($low,$high,5);
$g = log($amt/$p)/log(exp(1));
$disp_c = round($g/$k*1000)/1000;
$rd = round( $g/$k );
if ($rd > $g/$k ) {$ans_c = $rd +2003} else {$ans_c = $rd+2004};


Context()->texStrings;
BEGIN_TEXT
World poultry production was 77.2 million tons in the year 2004 and increasing
at a continuous rate of 1.6$PERCENT per year. Assume that this growth rate continues.
$PAR
(a) Write an exponential formula for world poultry production, \(P\), in million tons, as a function of the number of years, \(t\), since 2004.
$BR
$BR
\( P(t) = \) \{ ans_rule(25) \}

$PAR
(b) Use the formula to estimate world poultry production in the year $year.
$BR
$BR
Production is \{ ans_rule(10) \} million tons (Round to the nearest 0.001.)

$PAR
(c) Use a graph to estimate the year in which world poultry production goes over \($amt\) million tons.  (Hint:  Graph \(P\) and the line \(y = $amt\) and find the year corresponding to the input of the intersection. )
$BR
$BR
In the year \{ ans_rule(10) \}

END_TEXT
Context()->normalStrings;

ANS(Compute("$ans_a")->cmp(tolerance=>0.00000001,tolType=>"absolute") );
ANS(Compute("$ans_b")->cmp(tolerance=>0.001,tolType=>"absolute") );
ANS(Compute("$ans_c")->cmp(tolerance=>1.2,tolType=>"absolute") );

#ANS(fun_cmp( $ans_a,vars=>'t',tol=>0.0005 ) );
#ANS(num_cmp( $ans_b,tol=>0.0005 ) );
#ANS(num_cmp( $ans_c,tol=>1.2 ) );



$f = "$p*exp($k*x) for x in <0,25> using color:blue and weight:2";
$g = "$amt for x in <0,25> using color:red and weight:2";
$graph = init_graph(-2,60,25,120,'axes'=>[0,0],'ticks'=>[1,1]);
$graph->lb('reset');
$graph->lb(new Label(-.2,$amt,$amt,'black','right','bottom'));
$graph->lb(new Label($disp_c,$amt,"($disp_c,$amt)",'black','right','bottom'));
$point = closed_circle( $disp_c,$amt, black );
$graph -> stamps($point);
plot_functions( $graph, $f, $g);
$fig = image(insertGraph($graph), width => 200, height => 200, tex_size => 500);

$upper = $ans_c+1;

Context()->texStrings;
SOLUTION(EV3(<<'END_SOLUTION'));
$PAR
$BBOLD  SOLUTION $EBOLD
$PA
(a) We have \( P = $p e^{$k t} \).
$PAR
(b) In $year, \( t = $year - 2004 = $t \), and thus \( P = $p e^{$k \cdot $t} \approx $ans_b \ \) million tons.
$PAR
(c) We see in the figure below that \(P = $amt\) at approximately \(t = $disp_c\), which is sometime in $ans_c, prior to $upper.
$BR
$BCENTER
$fig
$ECENTER

END_SOLUTION
Context()->normalStrings;


COMMENT('MathObject version');
ENDDOCUMENT();
