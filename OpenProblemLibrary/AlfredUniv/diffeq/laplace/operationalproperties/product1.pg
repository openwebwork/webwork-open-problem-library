##KEYWORDS('laplace', 'convolution')
##DESCRIPTION
## Use integration by parts to evaluate an integral
##ENDDESCRIPTION

## DBsubject('Calculus')
## DBchapter('Differential Equations')
## DBsection('Laplace Transforms')
## Date('11/13/2010')
## Author('Darwyn Cook')
## Institution('')
## TitleText1('')
## EditionText1('')
## AuthorText1('Zill')
## Section1('')
## Problem1('')


DOCUMENT();        # This should be the first executable line in the problem.

loadMacros(
"PGbasicmacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
"MathObjects.pl",
"Alfredmacros.pl",
"weightedGrader.pl",
);
jsmathmode();
TEXT(beginproblem());
$showPartialCorrectAnswers = 1;
Context("Numeric");
Context()->variables->are(t=>"Real",s=>"Real",a=>"Real",m=>"Real",tau=>"Real");
Context()->variables->set(tau => {TeX => "\tau"});
$n = random(1,9);
$fact = 1;
for($i=1;$i<=$n;$i++){$fact = $fact*$i;};

## table has the format f, numerator of F, denominator of F
@Table = ([Formula("t^$n"),Formula("$fact"),Formula("s^($n+1)")],
[Formula("e^(m*t)"),Formula("1"),Formula("s-m")],
[Formula("cos(a*t)"),Formula("s"),Formula("a^2+s^2")],
[Formula("sin(a*t)"),Formula("a"),Formula("a^2+s^2")],
[Formula("sinh(a*t)"),Formula("-a"),Formula("a^2-s^2")],
[Formula("cosh(a*t)"),Formula("s"),Formula("s^2-a^2")]) ;


$numformulas = @Table;
$minusone = $numformulas-1;
$plusone = $numformulas + 1;

$choose1 = random(0,$minusone);
$choose2 = random(0,$minusone);

if($choose2 == $choose1){$choose2=($choose2 + 1)%$numformulas;}


$ftau =  $Table[$choose1][0]->substitute(t=>"tau");
$gtau =  $Table[$choose2][0]->substitute(t=>"tau");
$ftranslate =  $Table[$choose1][0]->substitute(t=>"t-tau");
$gtranslate =  $Table[$choose2][0]->substitute(t=>"t-tau");

$convolution1 = $ftau*$gtranslate;
$convolution2 = $gtau*$ftranslate;


$num = Formula("$Table[$choose1][1]*$Table[$choose2][1]");
$den = Formula("$Table[$choose1][2]*$Table[$choose2][2]");

$F = Formula($num/$den)->reduce;

Context()->texStrings;
BEGIN_TEXT
If \(L\lbrace f\rbrace (s) = $F\) then \[f(t) = \int_{\hbox{\{ans_rule(1)\}}}^{\hbox{\{ans_rule(1)\}}}{\hbox{\{ans_rule(20)\}}}\hskip 5pt d\tau\]
$BR
$BBOLD Note $EBOLD \(\tau\) is typed as tau.
END_TEXT
Context()->normalStrings;

WEIGHTED_ANS(Compute("0")->cmp, 5);
WEIGHTED_ANS(Formula("t")->cmp, 10);
WEIGHTED_ANS( $convolution1->cmp( checker=>sub {
     my ( $correct, $student, $ansHash ) = @_;
     return (($convolution1 == $student)||($convolution2 == $student));
} ), 85 );
ENDDOCUMENT();        # This should be the last executable line in the problem.
