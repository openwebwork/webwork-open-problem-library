##DESCRIPTION
##  Algebra problem: true or false for inequality 
##ENDDESCRIPTION

##KEYWORDS('PDE', 'laplacian', 'polar')

## DBsubject('Calculus')
## DBchapter('Partial Differential Equations')
## DBsection('Other Coordinate Systems')
## Date('9/12/2011')
## Author('Darwyn Cook')
## Institution('Alfred University')
## TitleText1('Differential Equations')
## EditionText1('6')
## AuthorText1('Zill')
## Section1('13.1')
## Problem1('')
########################################################################

DOCUMENT();      

loadMacros(
   "PGstandard.pl",     # Standard macros for PG language
   "MathObjects.pl",
   #"source.pl",        # allows code to be displayed on certain sites.
   "PGcourse.pl",      # Customization file for the course
   "Alfredmacros.pl",
   "answerHints.pl",
   "LiveGraphicsRectangularPlot3D.pl",
);
#"parserMultiAnswer.pl",
# Print problem number and point value (weight) for the problem
TEXT(beginproblem());

# Show which answers are correct and which ones are incorrect
$showPartialCorrectAnswers = 1;
#force the use of jsmath mode for the inline entry answer boxes
jsmathmode();
##############################################################
#
#  Setup
#
#
Context("Numeric");
Context()->variables->add(m=>'Real',n=>'Real');
$auxequationcontext = Context()->copy;

Context("Numeric");
Context()->variables->add(n=>'Real');
$integralcoefficientcontext = Context()->copy;

Context("Numeric");
Context()->variables->{namePattern} = qr/[a-z][a-z0-9_]*'*/i;
Context()->variables->add(theta=>'Real',m=>'Real',n=>'Real',r=>"Real",R=>"Real","R'"=>"Real","R''"=>"Real");
Context()->variables->set(theta => {TeX => '\theta'},"R'" => {TeX => '\frac{dR}{dr}'},"R'" => {TeX => '\frac{d^2R}{dr^2}'});

$amplitude = Compute(non_zero_random(-9,9));
$angle = Compute(random(2,8));
$n = Compute(random(1,5));
$frequency = Compute($angle*$n);
$boundary = Formula("$amplitude*sin($frequency*theta)");

$r = Compute(random(1,5));

$Theta = Formula("sin($angle*n*theta)");
$lambda = Formula("($angle*n)^2");

$DEinR = Formula("r^2*R''+r*R'-$lambda*R");
$R = Formula("r^($angle*n)");
$Rboundary = $R->substitute(r=>"$r");
$Bn = Formula("$amplitude/($r)^($angle*$n)");

##############################################################
#
#  Text
#
#

Context()->texStrings;
BEGIN_TEXT
Find the steady-state temperature \(u(r,\theta)\) in a quarter semi-circular plate of radius \(r = $r\) subject to the heat equation in polar coordinates
\[
\begin{aligned}
&\frac{\partial^2 u}{\partial r^2}+\frac{1}{r}\frac{\partial u}{\partial r} + \frac{1}{r^2}\frac{\partial^2 u}{\partial\theta^2} = 0\\
&\\
&u(r,0) = 0, 0 < r < $r, \\
&\\
&u\left(r,\frac{\pi}{$angle}\right) = 0, 0 < r < $r, \\
&\\
&u($r,\theta) = $amplitude\sin\left($frequency\theta\right), 0 < \theta < \frac{\pi}{$angle}\\
\end{aligned}
\]
$BR
As in the circular plate model we can separate the PDE into two ODE's with
$BR
\[
\begin{aligned}
r^2R^{\prime\prime}+rR^\prime-\lambda R = 0\\
\Theta^{\prime\prime}+\lambda\Theta = 0\\
\end{aligned}
\]
with 
$BR
\[
\begin{aligned}
\Theta(0) = \hbox{\{ans_rule(1)\}}\\
\Theta\left(\frac{\pi}{$angle}\right) = \hbox{\{ans_rule(1)\}}\\
\end{aligned}
\]
We can solve the BVP in \(\Theta\): \(\Theta(\theta)\) = \{ans_rule\} (without a coefficient). Therefore \(\sqrt{\lambda}\) is a multiple of an integer n, and  \(\lambda = \) \{ans_rule(5)\}
$BR
$BR
Now that we know \(\lambda\), we can rewrite the differential equation in R as (using the prime notation for derivatives): \{ans_rule\} \( = 0\).
$BR
This is a Cauchy-Euler equation. Substituting the guessed solution \(r^m\) into this equation we get the auxiliary equation \{ans_rule\} = 0. The only bounded solution at \(r=0\) is \(R(r) = \) \{ans_rule(5)\}
$BR
$BR
Therefore \(u(r,\theta) = \sum_{n=1}^\infty B_n\)\{ans_rule\}
$BR
$BBOLD Note $EBOLD We don't need \(n = 0\) since that term is zero.
$BR
$BR
The coefficients \(B_n\) are Fourier sine coefficients, therefore
$BR
\[
\begin{aligned}
B_n &= \displaystyle\frac{2}{\hbox{\{ans_rule(8)\}}}\int_0^{\hbox{\{ans_rule(3)\}}}\hbox{\{ans_rule(25)\}} d\theta\\
&\\
&=
\begin{cases}
\hbox{\{ans_rule(8)\}} & n = \hbox{\{ans_rule(2)\}}\\
0 & n \neq \hbox{\{ans_rule(2)\}}
\end{cases} \\
\end{aligned}
\]

END_TEXT
Context()->normalStrings;

##############################################################
#
#  Answers
#
#

#####
# Translate to ODE
#

#Theta IC
ANS(Compute("0")->cmp );
ANS(Compute("0")->cmp );
ANS($Theta->cmp);
ANS($lambda->cmp);

#Finding R
ANS($DEinR->cmp);
ANS(Formula($auxequationcontext,"m^2-$lambda")->cmp);
ANS($R->cmp);
ANS(Compute("$R*$Theta")->cmp);

# Fourier sine coefficients
ANS(Formula($integralcoefficientcontext,"pi/$angle*$Rboundary")->cmp);
ANS(Compute("pi/$angle")->cmp);
ANS(Formula("$Theta*$boundary")->cmp);

###
ANS($Bn->cmp);
ANS($n->cmp);
ANS($n->cmp);

ENDDOCUMENT();        
