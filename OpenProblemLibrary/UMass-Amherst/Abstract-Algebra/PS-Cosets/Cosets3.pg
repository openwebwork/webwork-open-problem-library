## DBsubject(Abstract algebra)
## DBchapter('Groups')
## DBsection('Cosets, Lagrange theorem and Normality')
## KEYWORDS('cosets')
## Level(3)
## TitleText1('')
## EditionText1('')
## AuthorText1('')
## Section1('')
## Problem1('')
## Author('Siman Wong and Patrick O'Brien')
## Institution('University of Massachusetts Amherst')


DOCUMENT();        # This should be the first executable line in the problem.

loadMacros(
"PG.pl",
"PGstandard.pl",
"MathObjects.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
"algebraMacros.pl"
);

TEXT(beginproblem());
$showPartialCorrectAnswers = 0;

Context()->strings->add(Y=>{});
Context()->strings->add(N=>{});


#
# In this problem we determine if a pair of elements of a group G
# lie in the same left H-cosets
#

$r1 = random(0,1,1);
$r2 = random(0,1,1);


#
# For part (i),  
#    G = Z
#    H = (n1)Z

$n1 = random(9,15,1);

# The three pairs of elements to be tested are (x_i, y_i), i=1,2,3
# For x:  random values 2 < x < n1
# For y1: n1 + (randomi negative number > -n1)
#     y2 & y3:  random non-zero integers in the range (-n1/2, n)

$x1 = random(3,$n1-1,1);
$x2 = random(3,$n1-1,1);
$x3 = random(3,$n1-1,1);
$negn1 = random(-$n1,-1,1);
$y1 = $n1 + $negn;
$y2 = random(-$n1/2,$n1,1);
if($r1 == 0){
    $y2 = ceil($y2);
}
else{
    $y2 = floor($y2);
}
while($y2 == 0){
    $y2 = random(-$n1/2,$n1,1);
    if($r1 == 0){
        $y2 = ceil($y2);
    }
    else{
        $y2 = floor($y2);
    }
}
$y3 = random(-$n1/2,$n1,1);
if($r2 == 0){
    $y3 = ceil($y3);
}
else{
    $y3 = floor($y3);
}
while($y3 == 0){
    $y3 = random(-$n1/2,$n1,1);
    if($r1 == 0){
        $y3 = ceil($y3);
    }
    else{
        $y3 = floor($y3);
    }
}

#
# For part (i):   (x_i, y_i) belong to the same left H-cosets 
#                 <==>  n1 divides y1-x1
#

if(($x1-$y1) % $n1 == 0){
    $a1 = Y;
}
else{
    $a1 = N;
}
if(($x2-$y2) % $n1 == 0){
    $a2 = Y;
}
else{
    $a2 = N;
}
if(($x3-$y3) % $n1 == 0){
    $a3 = Y;
}
else{
    $a3 = N;
}


#
# For part (ii):
#   G = dihedral of order 2*n2
#   H = cyclic subgroup generated by a^i b^j
#

$r3 = random(0,3,1);

@nset = (6, 8, 9, 10);

$n2 = $nset[$r3];

$d = 2*$n2;

#
# The three pairs are
#   (a, b^k1)                with k1= 0 or 1
#   (b, a^k2 b)              with 0 <= k2 < n
#   (b^j a^i, a^(n2 - 2i))
#

$i = random(1,$n2-1,1);
$i2 = 2*$i;
$ni2 = $n2 - $i2;
$j = random(0,2,1);

$k1 = random(0,1,1);
$k2 = random(0,$n2-1,1);

#
# Answer:
#  first pair:   Y <==> k1=0 and n2 divides (2i+1)
#  second:       Y <==> k2=0
#  third:        always Y
#


if($k1 == 0 || (2*$i+1) % $n2 == 0){
    $a4 = Y;
}
else{
    $a4 = N;
}
if($k2 == 0){
    $a5 = Y;
}
else{
    $a5 = N;
}
$a6 = Y;

BEGIN_TEXT

For each of the following problems you have a subgroup \(H\) of a group \(G\), and pairs of elements \((x,y)\) of \(G\). Determine if they belong to the same left \(H\)-cosets (answer Y/N). 

 $BR $BR

(i) \(G = \mathbb{Z}\) $BR
\(H = $n1 \mathbb{Z}\) $BR $BR

\{ begintable(4) \}
\{ row( "\((x,y)\)", "\(($x1,$y1)\)", "\(($x2,$y2)\)", "\(($x3,$y3)\)" )\}
\{ row( "\(xH = yH\)", ans_rule(10), ans_rule(10), ans_rule(10) ) \}
\{ endtable() \} $BR $BR

(ii) \(G = \{ dihedral( $n2 ) \} \) (dihedral of order $d, with generator \(a\), \(b\) where \(a^{$n2} = b^{2} = e\) and \(ba = a^{$n2-1}b\)$BR
\(H = \langle a^{$i} b^{$j} \rangle\) $BR $BR


\{ begintable(4) \}
\{ row( "\((x,y)\)", "\((a, b^{$k1})\)", "\((b, a^{$k2} b)\)", "\((b^{$j} a^{$i}, a^{$ni2})\)" )\}
\{ row( "\(xH = yH\)", ans_rule(10), ans_rule(10), ans_rule(10) ) \}
\{ endtable() \} $BR $BR



END_TEXT

ANS(str_cmp($a1) );
ANS(str_cmp($a2) );
ANS(str_cmp($a3) );

ANS(str_cmp($a4) );
ANS(str_cmp($a5) );
ANS(str_cmp($a6) );




ENDDOCUMENT();    