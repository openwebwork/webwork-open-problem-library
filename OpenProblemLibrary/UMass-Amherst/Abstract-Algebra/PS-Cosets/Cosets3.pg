## DBsubject(Abstract algebra)
## DBchapter('Groups')
## DBsection(Cosets, Lagrange's theorem, and normality)
## KEYWORDS('cosets')
## Level(3)
## TitleText1('')
## EditionText1('')
## AuthorText1('')
## Section1('')
## Problem1('')
## Author('Siman Wong and Patrick O'Brien')
## Institution('University of Massachusetts Amherst')


DOCUMENT();        # This should be the first executable line in the problem.

loadMacros(
  "PGstandard.pl",
  "MathObjects.pl",
  "PGcourse.pl"
);

TEXT(beginproblem());
$showPartialCorrectAnswers = 0;

Context("Numeric"); 

Context()->strings->add(Y=>{});
Context()->strings->add(N=>{});


#
# In this problem we determine if a pair of elements of a group G
# lie in the same left H-cosets
#

#
# For part (i),  
#    G = Z
#    H = (n1)Z

$n1 = random(9,15,1);

# The three pairs of elements to be tested are (x_i, y_i), i=1,2,3
# For x: three distinct random values 2 < x < n1
# For y: one or two in the subgroup, the others not

@xrange = (2 .. $n1-1);
for ($ii = 0; $ii < 3; $ii++){
   $jj = random($ii,$n1-3,1);
   ($xrange[$ii],$xrange[$jj])=($xrange[$jj],$xrange[$ii]);
}
($x1,$x2,$x3)=@xrange[0..2];

$yesno = ([1,0,0],[0,1,0],[0,0,1],[0,1,1],[1,0,1],[1,1,0])[random(0,5,1)];
for ($ii=0; $ii<3; $ii++){
    if ( $yesno->[$ii] ){ $y[$ii] = $xrange[$ii]+$n1; }
    else { $y[$ii] = $xrange[$ii] + random(1,$n1-1) % $n1; }
}
($y1,$y2,$y3)=@y;
         
#
# For part (i):   (x_i, y_i) belong to the same left H-cosets 
#                 <==>  n1 divides y1-x1
#

$a1 = ($x1-$y1) % $n1 == 0 ? Compute("Y") : Compute("N");
$a2 = ($x2-$y2) % $n1 == 0 ? Compute("Y") : Compute("N");
$a3 = ($x3-$y3) % $n1 == 0 ? Compute("Y") : Compute("N");

#
# For part (ii):
#   G = dihedral of order 2*n2
#   H = cyclic subgroup generated by a^i b^j
#

$r3 = random(0,3,1);

@nset = (6, 8, 9, 10);

$n2 = $nset[$r3];

$d = 2*$n2;

#
# The three pairs are
#   (a, b^k1)                with k1= 0 or 1
#   (b, a^k2 b)              with 0 <= k2 < n
#   (b^j a^i, a^(n2 - 2i))
#

$i = random(1,$n2-1,1);
$ni2 = $n2 - 2*$i;
$j = random(1,2,1);

$k1 = random(0,1,1);
$k2 = random(0,$n2-1,1);

#
# Answer is yes when:
# first pair: a^(-1)b^k1 = (a^ib^j)^m for some m so
#    j=k1=0 (mod 2) and gcd(i,n2)=1  or
#    j=k1=1 (mod 2) and -1=i (mod n2)
# second pair:  b^(-1) a^k2 b = a^(-k2) =  (a^ib^j)^m for some m so
#    k2 = 0 (mod n2) or 
#    j=0 (mod 2) and gcd(i,n2) | k2
# third pair: a^(-i) b^(-j) a^(n2-2i) = (a^ib^j)^m for some m so
#    j=0 (mod 2) and a^(n2-3i) = a^im so gcd(i,n2) | n2-3i (true)
#    j=1 (mod 2) and a^(-i)b a^(n2-2i) = a^(i-n2) b = (a^ib)^m so m=1 (true)
# so third pair is always true
#

$a4 = ( ($j % 2 == 0 and $k1 % 2 == 0 and gcd($i,$n2) == 1) 
        or ($j % 2 == 1 and $k1 % 2 == 1 and $i+1 % $n2 == 0) 
      ) ? Compute("Y") : Compute("N") ; 
$a5 = ( ($k2 % $n2 == 0) or ($j % 2 == 0 and $k2 % gcd($i,$n2) == 0 ) 
      )? Compute("Y") : Compute("N") ;
$a6 = Compute("Y");

Context()->texStrings;
BEGIN_TEXT
In each of the following problems you are given a subgroup \(H\) of a group \(G\), and pairs of elements \(x,y \in G\). Determine if \(x\) and \(y\) belong to the same left \(H\)-cosets.$BR 
Answer Y (for "yes") or N (for "no"). 

 $PAR

(i) \(G = \mathbb{Z}\); 
\(H = $n1 \mathbb{Z}\) $PAR

\{ begintable(4) \}
\{ row( "", "\(x=$x1, y=$y1\)", "\(x=$x2,y=$y2\)", "\(x=$x3,y=$y3\)" )\}
\{ row( "\(x+H = y+H\) ?", ans_rule(10), ans_rule(10), ans_rule(10) ) \}
\{ endtable() \} $PAR

(ii) \(G = \{ dihedral( $n2 ) \} \), dihedral group of order $d with generators \(a\), \(b\) where \(a^{$n2} = b^{2} = e\) and \(ba = a^{-1}b\);$BR
\(H = \langle a^{$i} b^{$j} \rangle\). $PAR


\{ begintable(4) \}
\{ row( "", "\(x=a, y=b^{$k1}\)", "\(x=b, y=a^{$k2} b\)", "\(x=b^{$j} a^{$i}, y=a^{$ni2}\)" )\}
\{ row( "\(xH = yH\) ?", ans_rule(10), ans_rule(10), ans_rule(10) ) \}
\{ endtable() \} $PAR

END_TEXT
Context()->normalStrings;

ANS($a1->cmp());
ANS($a2->cmp());
ANS($a3->cmp());

ANS($a4->cmp());
ANS($a5->cmp());
ANS($a6->cmp());

ENDDOCUMENT();    
