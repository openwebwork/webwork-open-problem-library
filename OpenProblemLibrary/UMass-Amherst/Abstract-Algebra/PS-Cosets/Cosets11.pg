## DBsubject(Abstract algebra)
## DBchapter('Groups')
## DBsection('Cosets, Lagrange theorem and Normality')
## KEYWORDS('cosets')
## Level(3)
## TitleText1('')
## EditionText1('')
## AuthorText1('')
## Section1('')
## Problem1('')
## Author('Siman Wong and Patrick O'Brien')
## Institution('University of Massachusetts Amherst')


DOCUMENT();        # This should be the first executable line in the problem.

loadMacros(
"PG.pl",
"PGstandard.pl",
"MathObjects.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
"parserRadioButtons.pl",
"algebraMacros.pl"
);

TEXT(beginproblem());
$showPartialCorrectAnswers = 0;

Context()->strings->add(Y=>{});
Context()->strings->add(N=>{});
Context()->strings->add(i=>{});
Context()->strings->add(j=>{});
Context()->strings->add(k=>{});
Context()->strings->add("-i"=>{});
Context()->strings->add("-j"=>{});
Context()->strings->add("-k"=>{});


#
# In this problem we determine if two elements of a given group
# belong to the same left H-coset
#


  # the first two groups are Z_n and U(n)
  #

@nset = (21, 22, 24, 25, 26, 27, 28, 30);
$r = random(0,7,1);
$n = $nset[$r];

  # for Z_n and U(n), the subgroup H we use are generated by the
  # same element k -- of course one is additive and the other is
  # multiplicative.    Specifically, 
  #    2<k<n-2   is a perfect square (mod n) with gcd(k,n)=1
  #    t         is a square-root of k (mod n)

$done=0;
while($done<1){
    $t = random(2, $n-2, 1);
    $k = ($t)^2 % $n;
    if ( gcd($k,$n)==1 ){
        $done=1;
    }
}         

$p = random(3,4,1);
$q = random(7,9,1);

  # here are the two elements for the first two groups
  # for Z_n:   always in the same H-coset since H=Z_n !!
  # for U(n):  same H-coset <==>  p=q (mod 2)

$a = $t^{$p} % $n;
$b = $t^{$q} % $n;

$a1 = Y;
if( ($p-$q)==0 % 2) {
    $a2 = Y;
}
else {
  $a2 = N;
}

  # the next two groups are both quaternion
  #

@dummy1 = (i, j, k);
$rd1 = random(0,2,1);
$rd2 = random(0,2,1);
while($rd1 == $rd2){
    $rd2 = random(0,2,1);
}
$rd3 = random(0,2,1);
while($rd1 == $rd3 || $rd2 == $rd3){
    $rd3 = random(0,2,1);
}

  # for the third part:
  #   c, d, e:    a permutation of i, j, k in the quaternion group
  #   H:     <c>
  #   d, e:  the two elements

$c = $dummy1[$rd1];
$d = $dummy1[$rd2];
$e = $dummy1[$rd3];

$a3 = Y;

  # for the fourth part:
  #   H:     <-1>
  #   f,g:   chosen randomly from the six order 4 elements

@dummy2 = ("-i", "-j", "-k", i, j, k);
$rrd1 = random(0,5,1);
$rrd2 = random(0,5,1);
while($rrd1 == $rrd2){
    $rrd2 = random(0,5,1);
}

$f = $dummy2[$rrd1];
$g = $dummy2[$rrd2];

$a4 = N;

$sw1 = 1;
$sw2 = 1;

if($rrd1 < 3){
    $sw1 = -1;
}
if($rrd2 < 3){
    $sw2 = -1;
}
if($sw1*$sw2 < 0){
    $a4 = Y;
}

BEGIN_TEXT

$BEGIN_ONE_COLUMN

For each of the following subgroups \(H\) of the respective groups \(G\), determine if the following elements represent the same left \(H\)-coset: $BR $BR

\{ begintable(5) \}
\{ row( "\(G\)", "\(H\)", "Element \(\#1\)", "Element \(\#2\)" , "Answer (Y/N)" )\}
\{ row( "\( ". cyclic( $n ) . " \)", "\(\langle $k \pmod{$n} \rangle\)", "\($a\)", "\($b\)", ans_rule(10) )\}
\{ row( "\(U($n)\)", "\(\langle $k \pmod{$n} \rangle\)", "\($a\)", "\($b\)", ans_rule(10)  )\}
\{ row( "\(" . quaternions() . "\)", "\(\langle $c \rangle\)", "\($d\)", "\($e\)", ans_rule(10) )\}
\{ row( "\(" . quaternions() . "\)", "\(\langle -1 \rangle\)", "\($f\)", "\($g\)", ans_rule(10) )\}

\{ endtable() \} $BR $BR



$END_ONE_COLUMN

END_TEXT

ANS(str_cmp($a1) );
ANS(str_cmp($a2) );
ANS(str_cmp($a3) );
ANS(str_cmp($a4) );

ENDDOCUMENT();   