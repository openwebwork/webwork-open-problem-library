 #DESCRIPTION
##  A problem to find the probability a Normal variable differs from its mean by at least a given value.
##ENDDESCRIPTION


## DBsubject(Probability)
## DBchapter(Continuous distributions)
## DBsection(Application of a normal distribution)
## Date(02/09/2013)
## Institution(The University of British Columbia)
## Author(Djun Kim)
## Level(3)
## KEYWORDS('statistics', 'continuous random variables', 'expectation', 'random variables', 'Normal distribution', 'tail probabilities')

DOCUMENT();

loadMacros(
  "PGstandard.pl",
  "PGchoicemacros.pl",
  "parserRadioButtons.pl",
  "MathObjects.pl",
  "PGstatisticsmacros.pl",
  "PGnumericalmacros.pl",
  "PGcourse.pl"
);

#######

TEXT(beginproblem());

$selector = random(0,1,1);

$c = random(1.2, 1.8, 0.1);

# ans = 2 * pnorm((c-3)/2, mean=0, sd=1, lower.tail=TRUE)
# The values of P[] are generated by the following R code:
# for (i = 12:18) {
#     c = i/10; 
#     print(sprintf("$P[%f] = %f", c, pnorm((c-3)/2, mean=0, sd=1, lower.tail=TRUE) )) 
# }
#
# Note: I'm using a hash for P,  not an array (braces, not square brackets),
# since indexing with a float doesn't work the way one might think.

# original
# $P{1.2} = 0.184060;
# $P{1.3} = 0.197663;
# $P{1.4} = 0.211855;
# $P{1.5} = 0.226627;
# $P{1.6} = 0.241964;
# $P{1.7} = 0.257846;
# $P{1.8} = 0.274253;

$P{1.2} = 0.5485062;
$P{1.3} = 0.5156922;
$P{1.4} = 0.4839273;
$P{1.5} = 0.4532547;
$P{1.6} = 0.4237108;
$P{1.7} = 0.3953251;
$P{1.8} = 0.3681203;

$zcomp = sprintf("%2.2f", $c/2);
$up = 3+$c;
$down = 3-$c;

# $ans = 2 * $P{$c};

$ans = 1. * $P{$c};

$half = $ans/2;

$ansrounded = sprintf("%2.2f", $ans);

$problem_text[0] = 
"If \( X \) is Normally distributed with a mean of 3 and a variance of 4, find \( P ( | X - 3|  > $c) \) to 2 decimal places.";

$problem_text[1] = 
"Suppose a car manufacturer believes its windscreen wipers will last on average for three years on their cars if driven by a typical driver in the province. Moreover, the manufacturer believes the lifetime of the wipers under such conditions is Normally distributed with a standard deviation of two years. Find the probability that, if on a car driven by a typical driver, a windscreen wiper lasts for a time that is not within $c years of the mean lifetime.";

$text = $problem_text[$selector];

$problem_sol[0] = "If \( X \sim N(3,4) \) and \( Z \sim N(0,1) \), we have $BR $BR \( P(|X - 3| > $c) \) $BR \( = P(X > $up) + P(X < $down) \) $BR \( = P(Z > \frac{$up-3}{2}) + P(Z < \frac{$down-3}{2}) \) $BR \( = P(Z > $zcomp) + P(Z < -$zcomp) \) $BR \( = (1 - P(Z < $zcomp)) + P(Z < -$zcomp) \) $BR \( = $half + $half \) $BR \( = $ansrounded \) $BR to 2 decimal places.";

$problem_sol[1] = "If \( X \) denotes the time the windscreen wiper lasts, then \( X \sim N(3,4) \) and we wish to find \( P(|X - 3| > $c) \). If \( Z \sim N(0,1) \), we have $BR $BR \( P(|X - 3| > $c) \) $BR \( = P(X > $up) + P(X < $down) \) $BR \( = P(Z > \frac{$up-3}{2}) + P(Z < \frac{$down-3}{2}) \) $BR \( = P(Z > $zcomp) + P(Z < -$zcomp) \) $BR \( = (1 - P(Z < $zcomp)) + P(Z < -$zcomp) \) $BR \( = $half + $half \) $BR \( = $ansrounded \) $BR to 2 decimal places.";

$sol = $problem_sol[$selector];

#######

Context()->texStrings;

BEGIN_TEXT
$text

$PAR
The probability is: \{ ans_rule(6) \}
END_TEXT


#######

$showPartialCorrectAnswers = 1;

ANS( num_cmp( $ans, tol=> 0.01, tolType=> 'absolute' ) );


##############################################################
#
#  Solution
#

Context()->texStrings;

BEGIN_SOLUTION
$BR $BR
$sol;

END_SOLUTION

Context()->normalStrings;


ENDDOCUMENT();
